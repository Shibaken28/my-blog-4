<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="謝罪 常体と敬体がごっちゃです。ごめんなさい。 エンタメとしてお楽しみください。
解法を書くのに、公式解説、公式解説放送を主に参考にしています。それだけで理解できなかったものは、他の方のブログを参考にしています。その際は、参考にしたブログのリンクを貼っています。
ABC212-G Power Pair 問題概要 素数$P$が与えられ、$x^n \equiv y \pmod{P}$を満たす$n$が存在する$(x,y)$の組$(0\leq x,y\leq P-1)$の個数を求める問題。
素数$P$に対する原始根$r$が必ず存在するため、$x=r^a,y=r^b$とか表現すると、 $$ x^n \equiv y \pmod{P} \Leftrightarrow r^{an} \equiv r^b \pmod{P} \Leftrightarrow an \equiv b \pmod{P-1} $$ となるので(最後の変換はフェルマーの小定理より)、$an \equiv b \pmod{P-1}$を満たす$(a,b)$の組$(1\leq a,b\leq P-1)$を数えれば良い。
さて、ここからどう数えるかだが、
$P-1$と$a$の最大公約数が$1$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$P-1$通りの値を取る。 $P-1$と$a$の最大公約数が$2$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/2$通りの値を取る。 というように、$P-1$と$a$の最大公約数が$g$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/g$通りの値を取ることがわかる。
$a=1,2,\cdots P-1$のそれぞれに対して$P-1$との最大公約数を取るのは$O(P\log P)$かかってしまうので、$GCD(P-1,a)$の値が$g$になるような$a$の個数を数えることにする。これは$g$が大きい順に数えるとうまくいく(説明がめんどいのでコードを貼ってごまかす)。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 mint ans = 1; map&amp;lt;long,long&amp;gt; mp; for(auto&amp;amp;i:f){ //fはP-1の約数(降順) // GCD(P-1, x) = iとなるxの個数を求める long n = P/i; for(auto&amp;amp;j:f){ if(j&amp;lt;=i)continue; if(j%i==0){ n -= mp[j]; } } mint a = P/i; mint b = n; ans += a*b; mp[i] = n; } 提出コード"><title>[WIP]ABCの高度典型を解いてうはうはしたい</title><link rel=canonical href=https://shibaken28.github.io/my-blog-4/contents/high-typical/><link rel=stylesheet href=/my-blog-4/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="[WIP]ABCの高度典型を解いてうはうはしたい"><meta property="og:description" content="謝罪 常体と敬体がごっちゃです。ごめんなさい。 エンタメとしてお楽しみください。
解法を書くのに、公式解説、公式解説放送を主に参考にしています。それだけで理解できなかったものは、他の方のブログを参考にしています。その際は、参考にしたブログのリンクを貼っています。
ABC212-G Power Pair 問題概要 素数$P$が与えられ、$x^n \equiv y \pmod{P}$を満たす$n$が存在する$(x,y)$の組$(0\leq x,y\leq P-1)$の個数を求める問題。
素数$P$に対する原始根$r$が必ず存在するため、$x=r^a,y=r^b$とか表現すると、 $$ x^n \equiv y \pmod{P} \Leftrightarrow r^{an} \equiv r^b \pmod{P} \Leftrightarrow an \equiv b \pmod{P-1} $$ となるので(最後の変換はフェルマーの小定理より)、$an \equiv b \pmod{P-1}$を満たす$(a,b)$の組$(1\leq a,b\leq P-1)$を数えれば良い。
さて、ここからどう数えるかだが、
$P-1$と$a$の最大公約数が$1$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$P-1$通りの値を取る。 $P-1$と$a$の最大公約数が$2$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/2$通りの値を取る。 というように、$P-1$と$a$の最大公約数が$g$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/g$通りの値を取ることがわかる。
$a=1,2,\cdots P-1$のそれぞれに対して$P-1$との最大公約数を取るのは$O(P\log P)$かかってしまうので、$GCD(P-1,a)$の値が$g$になるような$a$の個数を数えることにする。これは$g$が大きい順に数えるとうまくいく(説明がめんどいのでコードを貼ってごまかす)。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 mint ans = 1; map&amp;lt;long,long&amp;gt; mp; for(auto&amp;amp;i:f){ //fはP-1の約数(降順) // GCD(P-1, x) = iとなるxの個数を求める long n = P/i; for(auto&amp;amp;j:f){ if(j&amp;lt;=i)continue; if(j%i==0){ n -= mp[j]; } } mint a = P/i; mint b = n; ans += a*b; mp[i] = n; } 提出コード"><meta property="og:url" content="https://shibaken28.github.io/my-blog-4/contents/high-typical/"><meta property="og:site_name" content="shibak3n's blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2023-08-20T12:08:30+09:00"><meta property="article:modified_time" content="2023-08-20T12:08:30+09:00"><meta name=twitter:title content="[WIP]ABCの高度典型を解いてうはうはしたい"><meta name=twitter:description content="謝罪 常体と敬体がごっちゃです。ごめんなさい。 エンタメとしてお楽しみください。
解法を書くのに、公式解説、公式解説放送を主に参考にしています。それだけで理解できなかったものは、他の方のブログを参考にしています。その際は、参考にしたブログのリンクを貼っています。
ABC212-G Power Pair 問題概要 素数$P$が与えられ、$x^n \equiv y \pmod{P}$を満たす$n$が存在する$(x,y)$の組$(0\leq x,y\leq P-1)$の個数を求める問題。
素数$P$に対する原始根$r$が必ず存在するため、$x=r^a,y=r^b$とか表現すると、 $$ x^n \equiv y \pmod{P} \Leftrightarrow r^{an} \equiv r^b \pmod{P} \Leftrightarrow an \equiv b \pmod{P-1} $$ となるので(最後の変換はフェルマーの小定理より)、$an \equiv b \pmod{P-1}$を満たす$(a,b)$の組$(1\leq a,b\leq P-1)$を数えれば良い。
さて、ここからどう数えるかだが、
$P-1$と$a$の最大公約数が$1$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$P-1$通りの値を取る。 $P-1$と$a$の最大公約数が$2$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/2$通りの値を取る。 というように、$P-1$と$a$の最大公約数が$g$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/g$通りの値を取ることがわかる。
$a=1,2,\cdots P-1$のそれぞれに対して$P-1$との最大公約数を取るのは$O(P\log P)$かかってしまうので、$GCD(P-1,a)$の値が$g$になるような$a$の個数を数えることにする。これは$g$が大きい順に数えるとうまくいく(説明がめんどいのでコードを貼ってごまかす)。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 mint ans = 1; map&amp;lt;long,long&amp;gt; mp; for(auto&amp;amp;i:f){ //fはP-1の約数(降順) // GCD(P-1, x) = iとなるxの個数を求める long n = P/i; for(auto&amp;amp;j:f){ if(j&amp;lt;=i)continue; if(j%i==0){ n -= mp[j]; } } mint a = P/i; mint b = n; ans += a*b; mp[i] = n; } 提出コード"><script async src="https://www.googletagmanager.com/gtag/js?id=G-KXVWMJ76L6"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-KXVWMJ76L6")</script><link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP" rel=stylesheet><style>:root{--ja-font-family:"Noto Sans JP",'ヒラギノ角ゴ Pro W3', 'Hiragino Kaku Gothic Pro', '游ゴシック', 'Yu Gothic', 'ＭＳ Ｐゴシック', 'MS PGothic', sans-serif;--base-font-family:"Lato", var(--sys-font-family), var(--ja-font-family), sans-serif;--article-font-size:12pt}.article-content .katex-display>.katex{overflow-x:hidden;overflow-y:hidden}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=メニューを開く・閉じる>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/my-blog-4>shibak3n's blog</a></h1><h2 class=site-description>趣味全般</h2></div></header><ol class=social-menu><li><a href=https://github.com/Shibaken28 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://steamcommunity.com/profiles/76561199155194438/ target=_blank title=steam rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li><li><a href=https://twitter.com/Shibak33333333n target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/my-blog-4/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/my-blog-4/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/my-blog-4/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/my-blog-4/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>ダークモード</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目次</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#謝罪>謝罪</a></li><li><a href=#abc212-g-power-pair>ABC212-G Power Pair</a><ol><li><a href=#問題概要>問題概要</a></li><li><a href=#感想>感想</a></li></ol></li><li><a href=#abc212-h-nim-counting>ABC212-H Nim Counting</a><ol><li><a href=#問題概要-1>問題概要</a></li><li><a href=#hadamard変換>Hadamard変換</a></li><li><a href=#高速walsh-hadamard変換>高速Walsh-Hadamard変換</a></li><li><a href=#問題に戻る>問題に戻る</a></li><li><a href=#参考サイト>参考サイト</a></li><li><a href=#感想-1>感想</a></li></ol></li><li><a href=#abc213-g-connectivity-2>ABC213-G Connectivity 2</a><ol><li><a href=#問題概要-2>問題概要</a></li><li><a href=#言い換え>言い換え</a></li><li><a href=#gsの計算>g(S)の計算</a></li><li><a href=#fsの計算>f(S)の計算</a></li><li><a href=#部分集合の部分集合の列挙>部分集合の部分集合の列挙</a></li><li><a href=#感想-2>感想</a></li></ol></li><li><a href=#abc213-h-stroll>ABC213-H Stroll</a><ol><li><a href=#問題概要-3>問題概要</a></li><li><a href=#dp解>DP解</a></li><li><a href=#分割統治fft>分割統治FFT</a></li><li><a href=#感想-3>感想</a></li></ol></li><li><a href=#abc214-g-three-permutations>ABC214-G Three Permutations</a><ol><li><a href=#包除原理>包除原理</a></li><li><a href=#グラフに変換>グラフに変換</a></li><li><a href=#dpで計算>DPで計算</a></li></ol></li><li><a href=#abc214-h-collecting>ABC214-H Collecting</a><ol><li><a href=#問題概要-4>問題概要</a></li><li><a href=#最小費用流問題>最小費用流問題</a></li><li><a href=#参考サイト-1>参考サイト</a></li><li><a href=#感想-4>感想</a></li></ol></li><li><a href=#abc215-g-colorful-candies-2>ABC215-G Colorful Candies 2</a><ol><li><a href=#式を作る>式を作る</a></li><li><a href=#計算量について>計算量について</a></li><li><a href=#感想-5>感想</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/my-blog-4/categories/%E7%AB%B6%E3%83%97%E3%83%AD/>競プロ</a>
<a href=/my-blog-4/categories/%E6%97%A5%E8%A8%98/>日記</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/my-blog-4/contents/high-typical/>[WIP]ABCの高度典型を解いてうはうはしたい</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Aug 20, 2023</time></div></footer></div></header><section class=article-content><h2 id=謝罪>謝罪</h2><p>常体と敬体がごっちゃです。ごめんなさい。
エンタメとしてお楽しみください。</p><p>解法を書くのに、公式解説、公式解説放送を主に参考にしています。それだけで理解できなかったものは、他の方のブログを参考にしています。その際は、参考にしたブログのリンクを貼っています。</p><h2 id=abc212-g-power-pair>ABC212-G Power Pair</h2><h3 id=問題概要>問題概要</h3><p>素数$P$が与えられ、$x^n \equiv y \pmod{P}$を満たす$n$が存在する$(x,y)$の組$(0\leq x,y\leq P-1)$の個数を求める問題。</p><p>素数$P$に対する原始根$r$が必ず存在するため、$x=r^a,y=r^b$とか表現すると、
$$
x^n \equiv y \pmod{P} \Leftrightarrow r^{an} \equiv r^b \pmod{P} \Leftrightarrow an \equiv b \pmod{P-1}
$$
となるので(最後の変換はフェルマーの小定理より)、$an \equiv b \pmod{P-1}$を満たす$(a,b)$の組$(1\leq a,b\leq P-1)$を数えれば良い。</p><p>さて、ここからどう数えるかだが、</p><ul><li>$P-1$と$a$の最大公約数が$1$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$P-1$通りの値を取る。</li><li>$P-1$と$a$の最大公約数が$2$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/2$通りの値を取る。</li></ul><p>というように、$P-1$と$a$の最大公約数が$g$であるような$a$を見つけてきたとき、$n=1,2,\cdots P-1$のとき$b$は$(P-1)/g$通りの値を取ることがわかる。</p><p>$a=1,2,\cdots P-1$のそれぞれに対して$P-1$との最大公約数を取るのは$O(P\log P)$かかってしまうので、$GCD(P-1,a)$の値が$g$になるような$a$の個数を数えることにする。これは$g$が大きい順に数えるとうまくいく(説明がめんどいのでコードを貼ってごまかす)。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>mint</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>map</span><span class=o>&lt;</span><span class=kt>long</span><span class=p>,</span><span class=kt>long</span><span class=o>&gt;</span> <span class=n>mp</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=nl>i</span><span class=p>:</span><span class=n>f</span><span class=p>){</span> <span class=c1>//fはP-1の約数(降順)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// GCD(P-1, x) = iとなるxの個数を求める
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>long</span> <span class=n>n</span> <span class=o>=</span> <span class=n>P</span><span class=o>/</span><span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=nl>j</span><span class=p>:</span><span class=n>f</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>i</span><span class=p>)</span><span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>%</span><span class=n>i</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>-=</span> <span class=n>mp</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>mint</span> <span class=n>a</span> <span class=o>=</span> <span class=n>P</span><span class=o>/</span><span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mint</span> <span class=n>b</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>+=</span> <span class=n>a</span><span class=o>*</span><span class=n>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://atcoder.jp/contests/abc212/submissions/44847610 target=_blank rel=noopener>提出コード</a></p><h3 id=感想>感想</h3><p>原始根って便利なんですね</p><h2 id=abc212-h-nim-counting>ABC212-H Nim Counting</h2><h3 id=問題概要-1>問題概要</h3><p>長さ$K$の数列$(A_1,A_2,\cdots,A_K)$が与えられ($1\leq A_i\leq 2^{16}$)、ここから$1$個以上$N$個以下の数を選び(重複可能)、それらの選んだ数のXORをとったとき、$0$に<strong>ならない</strong>ような選び方の個数を求める問題。</p><p>この問題ではxorの畳み込みという技術を使います。xorの演算子を$\oplus$、xor畳み込みの演算子を$*$とすると、xor畳み込みというのは、</p><p>$$
A = (a_1, a_2, \cdots, a_n) \\
B = (b_1, b_2, \cdots, b_n) \\
c_i = \sum_{x\oplus y = i} a_x b_y
$$
となるようなベクトル$C = A * B = (c_1, c_2, \cdots, c_n)$を求めることで、$O(n\log n)$で行えます。すなわち、これでxor畳み込み後に添え字が0$以外の要素の総和を求めることでこの問題は解けそうです。</p><h3 id=hadamard変換>Hadamard変換</h3><p>天下り的ですが、
$$
\begin{aligned}
H_0 &= 1 \\
H_k &= \begin{pmatrix}
E_{k-1} & E_{k-1} \\
E_{k-1} & -E_{k-1} \end{pmatrix}
\begin{pmatrix}
H_k & 0 \\\
0 & H_k
\end{pmatrix}
\end{aligned}
$$
と行列$H_i$を定義します($E_k$は$k$次の単位行列)。このとき、$H_k$は$2^k$次の行列です。
$$
H_k H_k = 2^k E_{2^k}
$$
が成り立ちますので、$H_k^{-1} = 2^{-k} H_k$となります。また、
長さ$2^k$のベクトル$A$と$B$に対して次が成り立ちます。
$$
(H_k A) (H_k B) = H_k (A * B)
$$
左辺はベクトルの各要素ごとの積を表しています。これを変形すると、
$$
A * B = 2^{-k} H_k ((H_k A) (H_k B))
$$
が成り立ちます。しかし、これは長さ$2^k$のベクトルと$2^k$次の正方行列の積の計算をする必要がありますので、$n=2^k$として、結局$O(n^2)$かかってしまいます。
しかし、この行列$H_k$とベクトルの積はうまいことに高速化ができます。</p><h3 id=高速walsh-hadamard変換>高速Walsh-Hadamard変換</h3><p>$H_k$を変形します。
$$
\begin{aligned}
H_k &=
\begin{pmatrix}
E_{k-1} & E_{k-1} \\
E_{k-1} & -E_{k-1}
\end{pmatrix}
\begin{pmatrix}
H_k & 0 \\\
0 & H_k
\end{pmatrix} \\
&=
\begin{pmatrix}
E_{k-1} & E_{k-1} \\
E_{k-1} & -E_{k-1}
\end{pmatrix}
\begin{pmatrix}
E_{k-2} & E_{k-2} & 0 & 0 \\
E_{k-2} & -E_{k-2} & 0 & 0 \\
0 & 0 & E_{k-2} & E_{k-2} \\
0 & 0 & E_{k-2} & -E_{k-2}
\end{pmatrix}
\begin{pmatrix}
H_{k-2} & 0 & 0 & 0 \\
0 & H_{k-2} & 0 & 0 \\
0 & 0 & H_{k-2} & 0 \\
0 & 0 & 0 & H_{k-2}
\end{pmatrix} \\
&= \cdots
\end{aligned}
$$
この行列の積への分解は高々$O(\log n)$回で終わります(上記の変形をし続けると最後に$H_0$が対角上に並んだ行列、すなわち単位行列が現れます)。
そして、各分解された行列をよく見ると、各行で$0$ではない要素は必ず$2$つです。すなわち、この分解された行列単体とベクトルの積は、$O(n)$で行うことができ、行列は$O(\log n)$個しかありませんので、結局$O(n\log n)$で行うことができます。</p><p>ピンと来ないという私のために、$n=8$のときの$H_3$を分解してみます。
$$
\begin{aligned}
H_3 &=
\begin{pmatrix}
E_2 & E_2 \\
E_2 & -E_2
\end{pmatrix}
\begin{pmatrix}
E_1 & E_1 & 0 & 0 \\
E_1 & -E_1 & 0 & 0 \\
0 & 0 & E_1 & E_1 \\
0 & 0 & E_1 & -E_1
\end{pmatrix} \\&
\begin{pmatrix}
E_0 & E_0 & 0 & 0 & 0 & 0 & 0 & 0 \\
E_0 & -E_0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & E_0 & E_0 & 0 & 0 & 0 & 0 \\
0 & 0 & E_0 & -E_0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & E_0 & E_0 & 0 & 0 \\
0 & 0 & 0 & 0 & E_0 & -E_0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & E_0 & E_0 \\
0 & 0 & 0 & 0 & 0 & 0 & E_0 & -E_0
\end{pmatrix}
\begin{pmatrix}
H_0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & H_0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & H_0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & H_0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & H_0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & H_0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & H_0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & H_0
\end{pmatrix} \\
&=
\begin{pmatrix}
1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\
1 & 0 & 0 & 0 & -1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & -1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & -1
\end{pmatrix}
\begin{pmatrix}
1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 \\
1 & 0 & -1 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & -1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \\
0 & 0 & 0 & 0 & 1 & 0 & -1 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 & -1
\end{pmatrix} \\&
\begin{pmatrix}
1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & -1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & -1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 & -1
\end{pmatrix}
\end{aligned}
$$
これを実装するのにも結構頭を使います。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span> <span class=nc>T</span><span class=o>&gt;</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>Hadamard</span><span class=p>(</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=n>A</span><span class=p>,</span><span class=k>const</span> <span class=kt>int</span> <span class=n>k</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 2^k次行列
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>((</span><span class=kt>int</span><span class=p>)</span><span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=o>!=</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;A size should be 2^k&#34;</span><span class=o>&lt;&lt;</span><span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>res</span> <span class=o>=</span> <span class=n>A</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>h</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>k</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>tmp</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span><span class=p>);</span><span class=n>j</span><span class=o>+=</span><span class=n>h</span><span class=o>*</span><span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=o>=</span><span class=n>j</span><span class=p>;</span><span class=n>l</span><span class=o>&lt;</span><span class=n>j</span><span class=o>+</span><span class=n>h</span><span class=p>;</span><span class=n>l</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>+</span> <span class=n>res</span><span class=p>[</span><span class=n>l</span><span class=o>+</span><span class=n>h</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span><span class=p>[</span><span class=n>l</span><span class=o>+</span><span class=n>h</span><span class=p>]</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>-</span> <span class=n>res</span><span class=p>[</span><span class=n>l</span><span class=o>+</span><span class=n>h</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>            
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span> <span class=nc>T</span><span class=o>&gt;</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>xor_convolution</span><span class=p>(</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=n>A</span><span class=p>,</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=n>B</span><span class=p>,</span><span class=k>const</span> <span class=kt>int</span> <span class=n>k</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// xor convolution
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// A,Bのサイズは2^k
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>a</span> <span class=o>=</span> <span class=n>Hadamard</span><span class=p>(</span><span class=n>A</span><span class=p>,</span><span class=n>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>b</span> <span class=o>=</span> <span class=n>Hadamard</span><span class=p>(</span><span class=n>B</span><span class=p>,</span><span class=n>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span><span class=p>);</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>Hadamard</span><span class=p>(</span><span class=n>res</span><span class=p>,</span><span class=n>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=p>;</span> <span class=c1>//これを2^kで割る必要がある
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>このコードは最後に得た値の各要素を$2^k$で割り算してやる必要があるので注意です。</p><h3 id=問題に戻る>問題に戻る</h3><p>問題で求めたいのは、$C=(c_1,c_2,\cdots,c_{2^{16}})$($c_i$は$i$個の石がある山の個数)があって、
$$
H(H(C)) + H((H(C))^2) + H((H(C))^3) + \cdots + H((H(C))^N)
$$
です($C^i$は各要素の$i$乗を取ることを意味します)。Hadamard変換は線形変換なので、次のように変形できます。$D=H(C)$とすると、
$$
H( D + D^2 + D^3 + \cdots + D^N)
$$
かなりスッキリしました。あとは、等比数列の和の公式を使って、括弧の中身を計算することができます。</p><p>等比数列の和の公式は
$$
\frac{d_i(d_i^N-1)}{d_i-1}
$$
です。$d_i=0,1$の場合はこのまま計算すると値がおかしくなるのでそこだけ別処理することに注意します。</p><p><a class=link href=https://atcoder.jp/contests/abc212/submissions/45251406 target=_blank rel=noopener>提出コード</a></p><h3 id=参考サイト>参考サイト</h3><ul><li><a class=link href=https://yamate11.github.io/blog/posts/2021/08-10-xor-conv/ target=_blank rel=noopener>yamate11のブログ xor畳み込み</a></li><li><a class=link href=https://qiita.com/izu_nori/items/7810fc2bc0423c8d407f target=_blank rel=noopener>Qiita xor畳み込みと高速Hadamard変換</a></li></ul><h3 id=感想-1>感想</h3><p>これのAND版やOR版もあるらしい。考えた人天才。</p><h2 id=abc213-g-connectivity-2>ABC213-G Connectivity 2</h2><h3 id=問題概要-2>問題概要</h3><p>$N$頂点$M$辺の単純無向グラフ$G$で、$0$本以上の辺を取り除いて新しいグラフ$H$を作る。各$k=2,3,\cdots,N$に対して、頂点$1$と$k$が$H$で連結になるような辺の取り除き方の個数を求める問題。</p><h3 id=言い換え>言い換え</h3><p>問題で求められている「頂点$1$と$k$が連結(ry」の個数を$C(k)$とします。また、次のように$f(S),g(S)$を定義します。</p><ul><li>$f(S) := $ $S$を頂点集合とする$G$の連結部分グラフの個数</li><li>$g(S) := $ $S$を頂点集合とする$H$の部分グラフの個数</li></ul><p>すると、次のように$C(k)$を表現できます。ちなみに$V$は$G$の頂点集合です。
$$
C(k) = \sum_{\lbrace 1,k \rbrace \subset S \subset V} f(S) g(V\setminus S)
$$
全ての$f(S),g(S)$が既知ならば、これは$O(N2^N)$で計算できます。</p><h3 id=gsの計算>g(S)の計算</h3><p>これは簡単です。
辺の両端が頂点集合$S$に含まれるような辺の個数を$E(S)$とすれば、$2^{E(S)}$が$g(S)$になります。
各頂点集合について$M$個の辺がそれぞれ含まれているかどうかを判定するので$O(M2^N)$で計算できます。</p><h3 id=fsの計算>f(S)の計算</h3><p>問題はこちらです。$f(S)=g(S)-$(頂点集合が$S$であるような非連結なグラフの個数)です。$g(S)$は既知なので、後者を計算する必要があります。
連結でないグラフというのは、連結成分が$2$個以上あるグラフのことです。「この$2$個以上の連結成分」というのを、「$1$つの連結成分があって、残りの使ってない頂点たちを好きなようにしてもらう」という数え方をします。</p><p>$S$に含まれる頂点を$1$つ取ってきて、これを$v$とすると$f(S)$は次のようになります(この$v$がないとカウントが重複してしまいます)。
$$
f(S) = g(S) - \sum_{ v \in T \subsetneq S} f(T) g(S\setminus T)
$$</p><p>これを$S$についていい感じの順番で計算していくことで、$O(3^N)$で計算できます。</p><h3 id=部分集合の部分集合の列挙>部分集合の部分集合の列挙</h3><p>部分集合の$i$の部分集合$j$の列挙は$O(3^N)$でできます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>N</span><span class=p>);</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>&amp;=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// (i, j) は条件を満たす
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://atcoder.jp/contests/abc213/submissions/45311948 target=_blank rel=noopener>提出コード</a></p><h3 id=感想-2>感想</h3><p>$f(S),g(S)$に分けて$g(S)$の計算方法考えるのむずくね？？</p><h2 id=abc213-h-stroll>ABC213-H Stroll</h2><h3 id=問題概要-3>問題概要</h3><p><a class=link href=https://atcoder.jp/contests/abc213/tasks/abc213_h target=_blank rel=noopener>問題</a></p><p>DPで解けそうな問題設定だが、時間が間に合わない。</p><h3 id=dp解>DP解</h3><p>$d_{s,t}$を$t$キロメートル歩いて地点$s$にいる通り数とすると次のように計算できる。
$$
d_{s,t} = \sum _{(s^\prime,i,x)} d_{s^\prime,t-x} \times p_{i,t-x}
$$</p><p>ただし、シグマ記号は「$s^\prime$から$s$に向かう$i$番目の長さ$x$の道」を全てのペアについて足し合わせることを意味する。
これを$t$の小さい方から計算すれば$O(MT^2)$で計算できるがこれだと時間がかかりすぎる。</p><p>シンプルに$N=2$のときを考えると、
$$
d_{1,t} = \sum_u d_{2,u} \times p_{t-u}
$$
という式になって、畳み込みっぽい見た目をしている。実際には$d_{2,u}$が<strong>定数ならば</strong>畳み込みで計算できる。</p><h3 id=分割統治fft>分割統治FFT</h3><p><strong>定数ならば畳み込みができる</strong>ということで、半分を事前に計算して定数にし、いい感じに再帰的に計算するとなんと$O(T\log^2T)$で計算できてしまうのだ。言葉での説明が難しいので図を用意した。
図は単純に$1$次元のDPを分割統治FFTで解いたものである。</p><figure><img src=./img/ABC213.jpg width=50%><figcaption><h4>分割統治FFT</h4></figcaption></figure><p>ただ、計算に使用する数値は全て<strong>確定</strong>していなければならないので、以下のような順番で計算する必要がある。</p><figure><img src=./img/ABC213-2.jpg width=50%><figcaption><h4>分割統治FFT(計算順序)</h4></figcaption></figure><p>今回は、頂点ごとにDPの値を持つが、全ての辺について上記の図のような遷移があるので、各遷移を全ての辺ごとに行う。計算量は$O(MT\log^2T)$となる。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>DCFFT</span><span class=p>(</span><span class=kt>int</span> <span class=n>l</span><span class=p>,</span><span class=kt>int</span> <span class=n>r</span><span class=p>,</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>edge</span><span class=o>&gt;&amp;</span><span class=n>E</span><span class=p>,</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;&gt;&amp;</span><span class=n>p</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;&gt;&amp;</span><span class=n>dp</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span><span class=o>+</span><span class=n>r</span><span class=p>)</span><span class=o>/</span><span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>l</span><span class=o>+</span><span class=mi>1</span><span class=o>==</span><span class=n>r</span><span class=p>)</span><span class=k>return</span> <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DCFFT</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=n>m</span><span class=p>,</span><span class=n>E</span><span class=p>,</span><span class=n>p</span><span class=p>,</span><span class=n>dp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>E</span><span class=p>.</span><span class=n>size</span><span class=p>();</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=p>[</span><span class=n>u</span><span class=p>,</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>E</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=c1>// [m,r)を更新
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>        本来だったら
</span></span></span><span class=line><span class=cl><span class=cm>        for(int i=m;i&lt;r;i++){
</span></span></span><span class=line><span class=cl><span class=cm>            dp[v][i] += sum_x (dp[u][i-x]*p[v][x]);
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>        をやるが、FFTを使う
</span></span></span><span class=line><span class=cl><span class=cm>        */</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>dp2u</span> <span class=o>=</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>dp</span><span class=p>[</span><span class=n>u</span><span class=p>].</span><span class=n>begin</span><span class=p>()</span><span class=o>+</span><span class=n>l</span><span class=p>,</span> <span class=n>dp</span><span class=p>[</span><span class=n>u</span><span class=p>].</span><span class=n>begin</span><span class=p>()</span><span class=o>+</span><span class=n>m</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>p2</span> <span class=o>=</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span><span class=p>(</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span> <span class=n>p</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>begin</span><span class=p>()</span><span class=o>+</span><span class=n>r</span><span class=o>-</span><span class=n>l</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>dp3u</span> <span class=o>=</span> <span class=n>convolution</span><span class=p>(</span><span class=n>dp2u</span><span class=p>,</span><span class=n>p2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=n>m</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;</span><span class=n>r</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>dp</span><span class=p>[</span><span class=n>v</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp3u</span><span class=p>[</span><span class=n>j</span><span class=o>-</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>DCFFT</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>r</span><span class=p>,</span><span class=n>E</span><span class=p>,</span><span class=n>p</span><span class=p>,</span><span class=n>dp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://atcoder.jp/contests/abc213/submissions/45324097 target=_blank rel=noopener>提出コード</a></p><h3 id=感想-3>感想</h3><p>添字をミスりまくってめっちゃ時間かかった。
地味に赤diff初AC。</p><h2 id=abc214-g-three-permutations>ABC214-G Three Permutations</h2><ul><li><a class=link href=https://atcoder.jp/contests/abc214/tasks/abc214_g target=_blank rel=noopener>問題リンク</a></li></ul><h3 id=包除原理>包除原理</h3><p>条件が扱いづらいので、包除原理を使います。</p><ul><li>$f(x)$を、$x$個の相異なる添字を選んだときに、その添字で$p_i=r_i$または$q_i=r_i$となるような$r_i$の割り当て方の個数とする。</li></ul><p>すると、包除原理により、求める答えは
$$
N! + \sum_{x=1}^N (-1)^x f(x) (N-x)!
$$
となります。$(N-x)!$は残りの$N-x$個の添字に対する割り当て方の個数です。</p><p>この数え方にすぐに納得しない私は具体例を考えてみました。</p><ul><li>$N=3, p=(1,2,3), q=(2,3,1)$のとき<ul><li>$r=(3,1,2)$の$1$通りだけであるが、これを上記の計算式で求める。</li></ul></li><li>$f(1)$について<ul><li>$i=1$を被らせるとき、$r_1=1,2$のどちらかで$2$通り<ul><li>$(1,3,2),(1,2,3),(2,1,3),(2,3,1)$の$4$通りがある</li></ul></li><li>$i=2$を被らせるとき、$r_2=2,3$のどちらかで$2$通り<ul><li>$(2,1,3),(2,3,1),(3,1,2),(3,2,1)$の$4$通りがある</li></ul></li><li>$i=3$を被らせるとき、$r_3=3,1$のどちらかで$2$通り<ul><li>$(3,1,2),(3,2,1),(1,2,3),(1,3,2)$の$4$通りがある</li></ul></li><li>$f(1) = 2+2+2$</li><li>ここで注目したいのが、例えば$(1,2,3)$という順列は$i=1$と$i=2$のパターンの両方に含まれているということである。ここで$2$回取り除かれている順列は、$f(2)$以降で調整されていくのが包除原理である。</li></ul></li><li>$f(2)$について<ul><li>$i=1,2$を被らせるとき$(1,2,3),(1,3,2),(2,3,1)$の$3$通りがある</li><li>$i=2,3$を被らせるとき$(1,2,3),(3,2,1),(2,3,1)$の$3$通りがある</li><li>$i=3,1$を被らせるとき$(1,2,3),(2,1,3),(2,3,1)$の$3$通りがある</li><li>$f(2) = 9$</li><li>ここで、$(1,2,3),(2,3,1)$のパターンは逆に足しすぎていので、$f(3)$で調整する。</li></ul></li><li>$f(3)$について<ul><li>$i=1,2,3$を被らせるとき$(1,2,3),(2,3,1)$の$2$通りがある</li><li>$f(3) = 2$</li></ul></li><li>よって、$3! - 6\times 2! + 9\times 1! - 2\times 0! = 6 - 12 + 9 - 2 = 1$となり、正しく計算できていることがわかる。</li></ul><h3 id=グラフに変換>グラフに変換</h3><p>グラフを使います。頂点を$N$個用意して、頂点$p_i$と$q_i$を繋ぐ辺を張ります。</p><p><figure><img src=./img/ABC214-1.jpg width=50%><figcaption><h4>辺を張る</h4></figcaption></figure>ここで注意するべきは、連結成分は必ずサイクルになります。なぜなら、$p,q$はどちらも順列であるので、同じ数がちょうど$2$回出現する$\Leftrightarrow$頂点の次数が$2$であるからです。</p><p>「各辺は、その両端の頂点番号を使ってはいけない」ことを示します。
次の画像は被らせる添字とグラフの対応を表したものです(画像には「サイクル」とありますが、「連結成分」と書くべきでした)。</p><figure><img src=./img/ABC214-2.jpg width=50%><figcaption><h4>被らせる添字を選ぶ</h4></figcaption></figure><p>元のグラフの連結成分ごとに、$k$個の辺を選ぶ(=$k$個の数を被らせる)方法の場合の数をそれぞれ計算すれば、DPによって$f(x)$を計算できます。
次の節ではそれぞれの連結成分で、$k$個の辺を選ぶ方法の場合の数を計算する方法を説明します。</p><h3 id=dpで計算>DPで計算</h3><p>サイクル状の頂点と辺を、$v_1,e_1,v_2,e_2,\cdots,v_y,e_y,v_1$と割り振ります。</p><ul><li>DP[$i$][$j$] $:=$ $i$番目までの辺を使って、$j$個の辺を選んだときの場合の数</li></ul><p>しかし、これだと情報が不十分です。辺$e_1$を選ぶと$v_1,v_2$のどちらかを選べます。$e_1$が$v_2$を選んだ場合、$e_2$は$v_3$を選ぶしかありません。逆に、$e_1$が$v_1$を選んだか、$e_1$を選んでいない場合は、$e_2$は$v_2,v_3$の$2$つの選択肢から選ぶことができます。よって、この情報を追加します。</p><p>さらに、円環なので、一番初めの頂点$v_1$が使われたという情報によって、$e_y$が$v_1$が選べるかどうかが決まります。よって、この情報も追加します。</p><ul><li>DP[$i$][$j$][$k$][$l$] $:=$ $i$番目までの辺を使って、$j$個の辺を選んだとき、$i$番目の辺が$v_{i+1}$を選んだ/選んでいない($k=0/1$)、$v_1$を使った/使っていない($l=0/1$)の場合の数</li></ul><p>こちらのDPですが、遷移が多いので注意深く実装します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>mint</span> <span class=n>dp</span><span class=p>[</span><span class=mi>3001</span><span class=p>][</span><span class=mi>3001</span><span class=p>][</span><span class=mi>2</span><span class=p>][</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span> <span class=n>f</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>n</span><span class=o>==</span><span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span><span class=p>{</span><span class=n>mint</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=n>mint</span><span class=p>(</span><span class=mi>1</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>rep</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=mi>3001</span><span class=p>)</span><span class=n>rep</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=mi>3001</span><span class=p>)</span><span class=n>rep</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=n>rep</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>mint</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// nはサイクルの長さ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// dp[i][j][k][l] :=
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// i番目までの辺を見て、j個使ったとき、
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// k=0: 直前を使っていない k=1: 直前を使った
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// l=0: 0を使っていない l=1: 0を使った
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>dp</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=o>==</span><span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 使わない
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 前を使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 後ろを使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span><span class=k>else</span> <span class=nf>if</span><span class=p>(</span><span class=n>i</span><span class=o>==</span><span class=n>n</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 使わない
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 前を使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 後ろを使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>rep</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 使わない
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                        <span class=c1>// 前を使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                        <span class=c1>// 後ろを使う
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                        <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=n>l</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span> <span class=n>res</span><span class=p>(</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>mint</span><span class=p>(</span><span class=mi>0</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>rep</span><span class=p>(</span><span class=n>j</span><span class=p>,</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>rep</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>rep</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=mi>2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>                <span class=n>res</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>dp</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>][</span><span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><a class=link href=https://atcoder.jp/contests/abc214/submissions/45351007 target=_blank rel=noopener>提出コード</a></p><h2 id=abc214-h-collecting>ABC214-H Collecting</h2><h3 id=問題概要-4>問題概要</h3><p><a class=link href=https://atcoder.jp/contests/abc214/tasks/abc214_h target=_blank rel=noopener>問題リンク</a></p><p>$K$人で分担して有向グラフ上の落とし物をできるだけ多く拾う問題。</p><h3 id=最小費用流問題>最小費用流問題</h3><p>強連結成分にある落とし物はすべて取るのが最適なので、強連結成分一つをまとめて1つの頂点として考えた新しいグラフを作ります。そのグラフはDAGになります。(このとき、頂点$1$から辿ることができない頂点とその頂点から出てる辺は無視します)。</p><p>サンプル$1$の場合、次のようなグラフを作り$S$から$T$へ$K=2$だけ流せば最小コストの符号を取ったものが答えとなる。</p><figure><img src=./img/ABC214-5.jpg width=50%><figcaption><h4>最小費用流</h4></figcaption></figure><p>しかし、負辺があるので、(私が知っている)アルゴリズムが適用できない。</p><p>負辺を取り除いたものがこちらです。<figure><img src=./img/ABC214-6.jpg width=70%><figcaption><h4>負辺を取り除く</h4></figcaption></figure></p><p>SからTまでグラフにそって適当なルートを通ったときに、通った辺のコストが「全体の落とし物のうち拾えなかった個数」を示しています。</p><p>このようなグラフは、強連結成分分解後に$M$頂点にしてトポロジカル順に頂点番号をつけたグラフについて、次のような操作によって機械的に構築できます。</p><ul><li>各頂点$u$ごとに$i_u$と$o_u$を用意して、$i_u$から$o_u$に$(1,0)$と$(\infty,X_u)$の辺を張る。$X_u$</li><li>辺$(u,v)$に対して、$o_u$から$i_v$に$(\infty, X_{u+1}+X_{u+2}+\cdots+X_{v-1})$の辺を張る。</li><li>$S$から$i_1$に$(K,0)$の辺を張る。</li><li>各頂点$u$ごとに、$o_u$から$T$に$(\infty,X_{u+1}+X_{u+2}+\cdots +X_M)$の辺を張る。</li></ul><p>各頂点について容量が$1$の辺があるのは、一人だけ「$X_u$を拾えなかった」ことを回避できるからです。
よって、求まったコストを$K\sum_u X_u$から引けば答えになります。</p><p><a class=link href=https://atcoder.jp/contests/abc214/submissions/45450341 target=_blank rel=noopener>提出コード</a></p><h3 id=参考サイト-1>参考サイト</h3><ul><li><a class=link href=https://kmjp.hatenablog.jp/entry/2021/08/16/0930 target=_blank rel=noopener>kmjp&rsquo;s blog 2021-08-16 AtCoder ABC #214 : H - Collecting</a></li></ul><h3 id=感想-4>感想</h3><p>フローのこういうテクニックは覚えていきたい。</p><h2 id=abc215-g-colorful-candies-2>ABC215-G Colorful Candies 2</h2><p>$N$個のキャンディがあり、$i$番目のキャンディの色は$C_i$である。
$K=1,2,\cdots,N$について、$N$個のうち$K$個のキャンディを選ぶ(同様に確からしい)とき、キャンディの種類数の期待値を求める問題。</p><h3 id=式を作る>式を作る</h3><p>とりあえず$K$を固定して考える。確率変数$X_i$を種類$i$のキャンディを$1$以上選ぶとき$1$、選ばないとき$0$とすると、答えは次の式で求められる。
$$
E\left[\sum_i X_i\right] = \sum_i E\left[X_i\right]
$$
線形性で右辺に変形できる。その種類のキャンディが$m$個あった場合に$1$つ以上選ぶ組み合わせは$_N \text{C} _K - _{N-m} \text{C} _K$通りと二項係数で計算できる。</p><p>この計算方法だと、各$K$について最大$N$種類の計算をすることになるので、$O(N^2)$かかりそうだが、ちょうど$x$個ある種類のキャンディをまとめて数え上げれば$O(N\sqrt(N))$になる(詳しくはコード、計算量の節を参照)。</p><p>メインの実装自体はかなり簡潔。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>cin</span><span class=p>.</span><span class=n>tie</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>-&gt;</span><span class=n>sync_with_stdio</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>N</span><span class=p>;</span><span class=n>cin</span><span class=o>&gt;&gt;</span><span class=n>N</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Combination</span><span class=o>&lt;</span><span class=n>mint</span><span class=o>&gt;</span> <span class=n>comb</span><span class=p>(</span><span class=n>N</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=kt>int</span><span class=o>&gt;</span><span class=n>mp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>rep</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>N</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>c</span><span class=p>;</span><span class=n>cin</span><span class=o>&gt;&gt;</span><span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>mp</span><span class=p>[</span><span class=n>c</span><span class=p>]</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>mp2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=p>[</span><span class=n>k</span><span class=p>,</span><span class=n>v</span><span class=p>]</span><span class=o>:</span><span class=n>mp</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>mp2</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=o>++</span><span class=p>;</span> <span class=c1>//v個あるキャンディの種類数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>k</span><span class=o>&lt;=</span><span class=n>N</span><span class=p>;</span><span class=n>k</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>mint</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=p>[</span><span class=n>m</span><span class=p>,</span><span class=n>a</span><span class=p>]</span><span class=o>:</span><span class=n>mp2</span><span class=p>){</span>
</span></span><span class=line><span class=cl>            <span class=n>mint</span> <span class=n>A</span> <span class=o>=</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>ans</span> <span class=o>+=</span> <span class=p>(</span><span class=n>comb</span><span class=p>.</span><span class=n>com</span><span class=p>(</span><span class=n>N</span><span class=p>,</span><span class=n>k</span><span class=p>)</span> <span class=o>-</span> <span class=n>comb</span><span class=p>.</span><span class=n>com</span><span class=p>(</span><span class=n>N</span><span class=o>-</span><span class=n>m</span><span class=p>,</span><span class=n>k</span><span class=p>))</span> <span class=o>/</span> <span class=n>comb</span><span class=p>.</span><span class=n>com</span><span class=p>(</span><span class=n>N</span><span class=p>,</span><span class=n>k</span><span class=p>)</span> <span class=o>*</span> <span class=n>A</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>ans</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>map</code>を使っているため定数倍が重め。</p><p><a class=link href=https://atcoder.jp/contests/abc215/submissions/45464934 target=_blank rel=noopener>提出コード</a></p><h3 id=計算量について>計算量について</h3><p>$a_i$を種類$i$の個数だとすると、種類数(キャンディが$1$個以上ある)が$M$個、キャンディの総数が$N$個のとき、次の条件たちを満たす。</p><ul><li>$a_1+a_2+\cdots+a_M=N$</li><li>$1 \leq a_i \leq N$</li></ul><p>計算量は、$a_i$の種類数を$D$とすると、$O(DN)$である。$D$は高々$O(\sqrt N)$にしかならないというのがミソである。</p><p>なぜなら、$D$をできるだけ大きくしようとすると、$a_i$はできるだけ小さくするべきなので、
$a_1 = 1, a_2 = 2, \cdots$と設定していくべきであり、$1+2+3+\cdots+D = O(D^2) = O(N)$となる。</p><h3 id=感想-5>感想</h3><p>今回の記事の中ではかなり簡単に見えるが、$X_i$の定義を思いつくところは経験値が必要だと思った。</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>関連するコンテンツ</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/my-blog-4/contents/hennyu_taikenki/><div class=article-details><h2 class=article-title>高専→大学編入体験記</h2></div></a></article><article><a href=/my-blog-4/contents/sdvx-fav/><div class=article-details><h2 class=article-title>Sound Voltex お気に入り曲</h2></div></a></article><article><a href=/my-blog-4/contents/matrix-pow/><div class=article-details><h2 class=article-title>行列累乗まとめ</h2></div></a></article><article><a href=/my-blog-4/contents/procon32/><div class=article-details><h2 class=article-title>第32回全国高専プロコン競技部門参戦記と好きなお茶ランキング</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 -
2024 shibak3n's blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>テーマ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> は <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> によって設計されています。</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/my-blog-4/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>