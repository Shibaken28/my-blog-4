<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="全般 問題数が多くて雑になりました。ごめ
わからない場合は直接私に訊いてください。DiscordやTwitterでDMを送ってください。
約束 配布ファイルにある大きな数字や配列などは省略して示しています。 &amp;gt;&amp;gt;&amp;gt;で始まっている行はPythonのインタラクティブモードでの入力を表しています。 特に断りがない場合、全ての解答コードはPython3で書かれています。 RSAの問題で出てくる、$m,e,c$はそれぞれ平文、公開鍵、暗号文を表します。 ライブラリ 次のPythonライブラリを使います。
pycryptodome gmpy2 これらのライブラリは、pip install pycryptodome gmpy2でインストールできます。
便利ツール CyberChef データ変換に便利なサイトです。データ形式が充実しています。 Substitution Solver 換字式暗号を自動で解いてくれます。 Beginner 序盤の簡単な問題
welcome README.mdに書いてあります。sctf{welcome_to_shiba_ctf}
radix starter 1 こういうちょっとした計算はPythonのインタラクティブモードが便利です。
1 2 &amp;gt;&amp;gt;&amp;gt; bin(18) &amp;#39;0b10010 sctf{10010}
radix starter 2 sctf{11010100001011}
radix starter 3 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;10111&amp;#34;,2) 23 sctf{23}
radix starter 4 sctf{52394}
radix starter 5 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;3b&amp;#34;,16) 59 sctf{59}
radix starter 6 1 2 &amp;gt;&amp;gt;&amp;gt; hex(97) &amp;#39;0x61&amp;#39; sctf{61}"><title>ShibaCTF Writeup</title><link rel=canonical href=https://shibaken28.github.io/my-blog-4/contents/shiba-ctf-writeup/><link rel=stylesheet href=/my-blog-4/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="ShibaCTF Writeup"><meta property="og:description" content="全般 問題数が多くて雑になりました。ごめ
わからない場合は直接私に訊いてください。DiscordやTwitterでDMを送ってください。
約束 配布ファイルにある大きな数字や配列などは省略して示しています。 &amp;gt;&amp;gt;&amp;gt;で始まっている行はPythonのインタラクティブモードでの入力を表しています。 特に断りがない場合、全ての解答コードはPython3で書かれています。 RSAの問題で出てくる、$m,e,c$はそれぞれ平文、公開鍵、暗号文を表します。 ライブラリ 次のPythonライブラリを使います。
pycryptodome gmpy2 これらのライブラリは、pip install pycryptodome gmpy2でインストールできます。
便利ツール CyberChef データ変換に便利なサイトです。データ形式が充実しています。 Substitution Solver 換字式暗号を自動で解いてくれます。 Beginner 序盤の簡単な問題
welcome README.mdに書いてあります。sctf{welcome_to_shiba_ctf}
radix starter 1 こういうちょっとした計算はPythonのインタラクティブモードが便利です。
1 2 &amp;gt;&amp;gt;&amp;gt; bin(18) &amp;#39;0b10010 sctf{10010}
radix starter 2 sctf{11010100001011}
radix starter 3 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;10111&amp;#34;,2) 23 sctf{23}
radix starter 4 sctf{52394}
radix starter 5 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;3b&amp;#34;,16) 59 sctf{59}
radix starter 6 1 2 &amp;gt;&amp;gt;&amp;gt; hex(97) &amp;#39;0x61&amp;#39; sctf{61}"><meta property="og:url" content="https://shibaken28.github.io/my-blog-4/contents/shiba-ctf-writeup/"><meta property="og:site_name" content="shibak3n's blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="暗号"><meta property="article:published_time" content="2023-11-21T10:17:43+09:00"><meta property="article:modified_time" content="2023-11-21T10:17:43+09:00"><meta name=twitter:title content="ShibaCTF Writeup"><meta name=twitter:description content="全般 問題数が多くて雑になりました。ごめ
わからない場合は直接私に訊いてください。DiscordやTwitterでDMを送ってください。
約束 配布ファイルにある大きな数字や配列などは省略して示しています。 &amp;gt;&amp;gt;&amp;gt;で始まっている行はPythonのインタラクティブモードでの入力を表しています。 特に断りがない場合、全ての解答コードはPython3で書かれています。 RSAの問題で出てくる、$m,e,c$はそれぞれ平文、公開鍵、暗号文を表します。 ライブラリ 次のPythonライブラリを使います。
pycryptodome gmpy2 これらのライブラリは、pip install pycryptodome gmpy2でインストールできます。
便利ツール CyberChef データ変換に便利なサイトです。データ形式が充実しています。 Substitution Solver 換字式暗号を自動で解いてくれます。 Beginner 序盤の簡単な問題
welcome README.mdに書いてあります。sctf{welcome_to_shiba_ctf}
radix starter 1 こういうちょっとした計算はPythonのインタラクティブモードが便利です。
1 2 &amp;gt;&amp;gt;&amp;gt; bin(18) &amp;#39;0b10010 sctf{10010}
radix starter 2 sctf{11010100001011}
radix starter 3 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;10111&amp;#34;,2) 23 sctf{23}
radix starter 4 sctf{52394}
radix starter 5 1 2 &amp;gt;&amp;gt;&amp;gt; int(&amp;#34;3b&amp;#34;,16) 59 sctf{59}
radix starter 6 1 2 &amp;gt;&amp;gt;&amp;gt; hex(97) &amp;#39;0x61&amp;#39; sctf{61}"><script async src="https://www.googletagmanager.com/gtag/js?id=G-KXVWMJ76L6"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-KXVWMJ76L6")</script><link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP" rel=stylesheet><style>:root{--ja-font-family:"Noto Sans JP",'ヒラギノ角ゴ Pro W3', 'Hiragino Kaku Gothic Pro', '游ゴシック', 'Yu Gothic', 'ＭＳ Ｐゴシック', 'MS PGothic', sans-serif;--base-font-family:"Lato", var(--sys-font-family), var(--ja-font-family), sans-serif;--article-font-size:12pt}.article-content .katex-display>.katex{overflow-x:hidden;overflow-y:hidden}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=メニューを開く・閉じる>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/my-blog-4>shibak3n's blog</a></h1><h2 class=site-description>趣味全般</h2></div></header><ol class=social-menu><li><a href=https://github.com/Shibaken28 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://steamcommunity.com/profiles/76561199155194438/ target=_blank title=steam rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li><li><a href=https://twitter.com/Shibak33333333n target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/my-blog-4/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/my-blog-4/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/my-blog-4/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/my-blog-4/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>ダークモード</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目次</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#全般>全般</a><ol><li><a href=#約束>約束</a></li><li><a href=#ライブラリ>ライブラリ</a></li><li><a href=#便利ツール>便利ツール</a></li></ol></li><li><a href=#beginner>Beginner</a><ol><li><a href=#welcome>welcome</a></li><li><a href=#radix-starter-1>radix starter 1</a></li><li><a href=#radix-starter-2>radix starter 2</a></li><li><a href=#radix-starter-3>radix starter 3</a></li><li><a href=#radix-starter-4>radix starter 4</a></li><li><a href=#radix-starter-5>radix starter 5</a></li><li><a href=#radix-starter-6>radix starter 6</a></li><li><a href=#radix-starter-7>radix starter 7</a></li><li><a href=#radix-starter-8>radix starter 8</a></li><li><a href=#radix-starter-9>radix starter 9</a></li></ol></li><li><a href=#classic-cipher>Classic Cipher</a><ol><li><a href=#romantic>Romantic</a></li><li><a href=#sos>SOS</a></li><li><a href=#no-meaning>No meaning</a></li><li><a href=#zigzag>Zigzag</a></li><li><a href=#cylinder>Cylinder</a></li><li><a href=#square>Square</a></li><li><a href=#atcipher>AtCipher</a></li></ol></li><li><a href=#digital-crypto>Digital Crypto</a><ol><li><a href=#numbers>Numbers</a></li><li><a href=#long_to_bytes>long_to_bytes</a></li><li><a href=#compression>Compression</a></li><li><a href=#compression-2>Compression 2</a></li><li><a href=#kanji>Kanji</a></li><li><a href=#numbers-2>Numbers 2</a></li><li><a href=#emoji-cipher>Emoji cipher</a></li><li><a href=#http>http</a></li><li><a href=#sanity-check>Sanity Check</a></li><li><a href=#numbers-3>Numbers 3</a></li><li><a href=#glitch>Glitch</a></li><li><a href=#zzzzzzzzzzzzzz>zzzzzzzzzzzzzz</a></li><li><a href=#ultimate-caesar>Ultimate Caesar</a></li></ol></li><li><a href=#basic-math>Basic Math</a><ol><li><a href=#equation-1>Equation 1</a></li><li><a href=#equation-2>Equation 2</a></li><li><a href=#equation-3>Equation 3</a></li><li><a href=#equation-4>Equation 4</a></li><li><a href=#math-class-1>Math Class 1</a></li><li><a href=#math-class-2>Math Class 2</a></li><li><a href=#math-class-3>Math Class 3</a></li><li><a href=#math-class-4>Math Class 4</a></li><li><a href=#math-class-5>Math Class 5</a></li><li><a href=#math-class-6>Math Class 6</a></li><li><a href=#math-class-7>Math Class 7</a></li></ol></li><li><a href=#block-cipher>Block Cipher</a><ol><li><a href=#aes-starter>AES starter</a></li><li><a href=#ecb-starter>ECB starter</a></li><li><a href=#ofb-starter>OFB starter</a></li><li><a href=#cbc-starter>CBC starter</a></li><li><a href=#padding-escapade>Padding Escapade</a></li><li><a href=#format-detection>Format Detection</a></li></ol></li><li><a href=#modern-crypto>Modern Crypto</a><ol><li><a href=#xor-starter>XOR starter</a></li><li><a href=#xor-maze>XOR Maze</a></li><li><a href=#xor-xor-xor>XOR XOR XOR</a></li><li><a href=#foresight-14>Foresight? 1～4</a></li><li><a href=#foresight-final>Foresight? Final</a></li><li><a href=#modular-puzzle>Modular Puzzle</a></li><li><a href=#exphash>ExpHash</a></li><li><a href=#staircase>Staircase</a></li><li><a href=#smidgen>Smidgen</a></li><li><a href=#rsa-starter>RSA starter</a></li><li><a href=#each-rsa>Each RSA</a></li><li><a href=#small-rsa>Small RSA</a></li><li><a href=#rush-e>RUSH E</a></li><li><a href=#2d-lagrange>2D Lagrange</a></li><li><a href=#common-n-rsa>Common N RSA</a></li><li><a href=#many-rsa>Many RSA</a></li><li><a href=#unbalance-rsa>Unbalance RSA</a></li><li><a href=#cutrsa>CutRSA</a></li><li><a href=#insufficient-rsa>Insufficient RSA</a></li><li><a href=#everyone>@Everyone</a></li><li><a href=#hyperdefensiveness>Hyperdefensiveness</a></li><li><a href=#inverse-reversal>Inverse Reversal</a></li><li><a href=#dsa-starter>DSA starter</a></li><li><a href=#dh-starter>DH Starter</a></li><li><a href=#dhmo-backdoor>DHMO Backdoor</a></li><li><a href=#ecc-starter-1>ECC Starter 1</a></li><li><a href=#ecc-starter-2>ECC Starter 2</a></li><li><a href=#ecc-starter-3>ECC Starter 3</a></li><li><a href=#ecc-starter-4>ECC Starter 4</a></li><li><a href=#ecc-starter-5>ECC Starter 5</a></li><li><a href=#ecc-vs-rsa>ECC vs. RSA</a></li><li><a href=#knapsack-starter>Knapsack Starter</a></li><li><a href=#whats-in-the-bag>What&rsquo;s in the bag?</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/my-blog-4/categories/ctf/>CTF</a>
<a href=/my-blog-4/categories/crypto/>crypto</a>
<a href=/my-blog-4/categories/%E6%95%B0%E5%AD%A6/>数学</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/my-blog-4/contents/shiba-ctf-writeup/>ShibaCTF Writeup</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Nov 21, 2023</time></div></footer></div></header><section class=article-content><h2 id=全般>全般</h2><p>問題数が多くて雑になりました。ごめ</p><p>わからない場合は直接私に訊いてください。DiscordやTwitterでDMを送ってください。</p><h3 id=約束>約束</h3><ul><li>配布ファイルにある大きな数字や配列などは省略して示しています。</li><li><code>>>></code>で始まっている行はPythonのインタラクティブモードでの入力を表しています。</li><li>特に断りがない場合、全ての解答コードはPython3で書かれています。</li><li>RSAの問題で出てくる、$m,e,c$はそれぞれ平文、公開鍵、暗号文を表します。</li></ul><h3 id=ライブラリ>ライブラリ</h3><p>次のPythonライブラリを使います。</p><ul><li><code>pycryptodome</code></li><li><code>gmpy2</code></li></ul><p>これらのライブラリは、<code>pip install pycryptodome gmpy2</code>でインストールできます。</p><h3 id=便利ツール>便利ツール</h3><ul><li><a class=link href=https://icyberchef.com/ target=_blank rel=noopener>CyberChef</a><ul><li>データ変換に便利なサイトです。データ形式が充実しています。</li></ul></li><li><a class=link href=https://www.guballa.de/substitution-solver target=_blank rel=noopener>Substitution Solver</a><ul><li>換字式暗号を自動で解いてくれます。</li></ul></li></ul><h2 id=beginner>Beginner</h2><p>序盤の簡単な問題</p><h3 id=welcome>welcome</h3><p><code>README.md</code>に書いてあります。<code>sctf{welcome_to_shiba_ctf}</code></p><h3 id=radix-starter-1>radix starter 1</h3><p>こういうちょっとした計算はPythonのインタラクティブモードが便利です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>bin</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;0b10010</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{10010}</code></p><h3 id=radix-starter-2>radix starter 2</h3><p><code>sctf{11010100001011}</code></p><h3 id=radix-starter-3>radix starter 3</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>int</span><span class=p>(</span><span class=s2>&#34;10111&#34;</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>23</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{23}</code></p><h3 id=radix-starter-4>radix starter 4</h3><p><code>sctf{52394}</code></p><h3 id=radix-starter-5>radix starter 5</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>int</span><span class=p>(</span><span class=s2>&#34;3b&#34;</span><span class=p>,</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>59</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{59}</code></p><h3 id=radix-starter-6>radix starter 6</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>hex</span><span class=p>(</span><span class=mi>97</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;0x61&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{61}</code></p><h3 id=radix-starter-7>radix starter 7</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>int</span><span class=p>(</span><span class=s2>&#34;8128&#34;</span><span class=p>,</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>5939</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{5939}</code></p><h3 id=radix-starter-8>radix starter 8</h3><p>$1$の後ろに$0$が$a$個続く$2$進数は、$10$進数で$2^a$です。よって、$2^64$が答えです。<code>sctf{18446744073709551616}</code></p><h3 id=radix-starter-9>radix starter 9</h3><h2 id=classic-cipher>Classic Cipher</h2><p>だいたいの古典暗号は、ネットにソルバが転がっています。
古典暗号は、現代から見れば脆弱で、アソビのようにも感じますが、歴史的背景はかなり興味深いです。計算機を使わないからこその、アルゴリズムの創意工夫も見られて面白いです。</p><h3 id=romantic>Romantic</h3><p>シーザー暗号です。$14$文字後ろにずらします。<code>sctf{kimagur3_r0m4ntic}</code></p><h3 id=sos>SOS</h3><p>シンプルなモールス符号です。<code>sctf{LICENSE}</code></p><h3 id=no-meaning>No meaning</h3><p>換字式暗号です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>classic</span> <span class=n>ciphers</span> <span class=n>are</span> <span class=n>encryption</span> <span class=n>methods</span> <span class=n>that</span> <span class=n>have</span> <span class=n>been</span> <span class=n>used</span> <span class=k>for</span> <span class=n>centuries</span> <span class=n>to</span> <span class=n>secure</span> <span class=n>secret</span> <span class=n>messages</span><span class=o>.</span> <span class=n>these</span> <span class=n>ciphers</span> <span class=n>are</span> <span class=n>based</span> <span class=n>on</span> <span class=n>mathematical</span> <span class=n>algorithms</span><span class=p>,</span> <span class=n>transforming</span> <span class=n>plaintext</span> <span class=n>into</span> <span class=n>unreadable</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=n>readable</span> <span class=n>only</span> <span class=n>by</span> <span class=n>those</span> <span class=k>with</span> <span class=n>the</span> <span class=n>decryption</span> <span class=n>key</span><span class=o>.</span> <span class=n>examples</span> <span class=n>of</span> <span class=n>classic</span> <span class=n>ciphers</span> <span class=n>include</span> <span class=n>the</span> <span class=n>caesar</span> <span class=n>cipher</span><span class=p>,</span> <span class=n>which</span> <span class=n>replaces</span> <span class=n>each</span> <span class=n>letter</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>plaintext</span> <span class=k>with</span> <span class=n>a</span> <span class=n>fixed</span> <span class=n>number</span> <span class=n>of</span> <span class=n>positions</span> <span class=n>down</span> <span class=n>the</span> <span class=n>alphabet</span><span class=p>;</span> <span class=n>the</span> <span class=n>vigenere</span> <span class=n>cipher</span><span class=p>,</span> <span class=n>which</span> <span class=n>uses</span> <span class=n>multiple</span> <span class=n>caesar</span> <span class=n>ciphers</span> <span class=n>based</span> <span class=n>on</span> <span class=n>a</span> <span class=n>keyword</span><span class=p>;</span> <span class=n>the</span> <span class=n>playfair</span> <span class=n>cipher</span><span class=p>,</span> <span class=n>which</span> <span class=n>encrypts</span> <span class=n>pairs</span> <span class=n>of</span> <span class=n>letters</span> <span class=n>using</span> <span class=n>a</span> <span class=mi>5</span><span class=n>x5</span> <span class=n>grid</span><span class=p>;</span> <span class=n>the</span> <span class=n>rail</span> <span class=n>fence</span> <span class=n>cipher</span><span class=p>,</span> <span class=n>which</span> <span class=n>rearranges</span> <span class=n>plaintext</span> <span class=n>letters</span><span class=p>;</span> <span class=ow>and</span> <span class=n>the</span> <span class=n>enigma</span> <span class=n>machine</span><span class=p>,</span> <span class=n>which</span> <span class=n>was</span> <span class=n>famously</span> <span class=n>cracked</span> <span class=n>by</span> <span class=n>allied</span> <span class=n>codebreakers</span> <span class=n>during</span> <span class=n>world</span> <span class=n>war</span> <span class=n>ii</span><span class=o>.</span> <span class=n>by</span> <span class=n>the</span> <span class=n>way</span><span class=p>,</span> <span class=n>here</span> <span class=ow>is</span> <span class=n>flag</span><span class=p>:</span> <span class=n>sctf</span><span class=p>{</span><span class=n>plaintext_letters_substituted_with_different_ciphertext_letters</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=zigzag>Zigzag</h3><p>レールフェンス暗号(Rail Fence Cipher)です。
`sctf{r@1l_f3nc3_c1ph3r_15_@_53cur3_4nd_345y_70_und3r574nd}
以下のようにジグザグに文字を配置して1行ずつ読む、という暗号化です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>s       l       c 
</span></span><span class=line><span class=cl> c     1 _     _ 
</span></span><span class=line><span class=cl>  t   @   f   3
</span></span><span class=line><span class=cl>   f r     3 c
</span></span><span class=line><span class=cl>    {       n
</span></span></code></pre></td></tr></table></div></div><h3 id=cylinder>Cylinder</h3><p>スキュタレー暗号です。$n$文字飛ばしで読むと文が出てきます。
改行して縦読みすると簡単に解けます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>s{__05p
</span></span><span class=line><span class=cl>cy440t3
</span></span><span class=line><span class=cl>t0r_d3r
</span></span><span class=line><span class=cl>fu3g_p}
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{y0u_4r3_4_g00d_5t3pp3r}</code></p><h3 id=square>Square</h3><p>画像の出典でバレていますがヴィジュネル暗号(Vigenère cipher)です。シーザー暗号の改良版で、文字ごとにずらす数を変えます。この問題はKEYが分かっているので、デコードするだけです。
<code>sctf{supercalifragilisticexpialidocious}</code></p><h3 id=atcipher>AtCipher</h3><p>アトバシュ暗号(Atbash cipher)です。aをz、bをy、cをx、というようにアルファベットを変換します。この暗号はエンコードとデコードで行う操作が同じです。
<code>sctf{just_like_affine_cipher}</code></p><h2 id=digital-crypto>Digital Crypto</h2><p>現代暗号に分類するまでもない、エンコード形式などに関する問題です。</p><h3 id=numbers>Numbers</h3><p>文字コード(ASCII)です。<code>sctf{Numbers_are_a_common_language}</code></p><h3 id=long_to_bytes>long_to_bytes</h3><p>問題文の通りです。
<code>sctf{pycryptodome_is_one_of_the_most_important_library}</code></p><h3 id=compression>Compression</h3><p>base64です。<code>sctf{base64_enc0ded_s7ring_15_being_one}</code></p><h3 id=compression-2>Compression 2</h3><p>base32です。<code>sctf{B@s3_33_15_@v3ry_5ecure_3nc0d1ng_f0r_m@nypurp053s_bu7_1t_m@y_n07_b3_7h3_f@s73s7_0n3_f0r@ll_54tu@710n5}</code></p><h3 id=kanji>Kanji</h3><p>めっちゃ大規模なシーザー暗号です。1文字目を<code>s</code>と仮定したときにずらす数が決定するので、それを使ってデコードします。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>S = &#34;籼籬籽籯粄籛簹籽籉籽簺簹籷籨簺簾籨簾簺籶籹籵簼籨簯簼籯籯簼籬籀簺籿簼粆&#34;
</span></span><span class=line><span class=cl>k = ord(S[0])-ord(&#39;s&#39;)
</span></span><span class=line><span class=cl>for c in S:
</span></span><span class=line><span class=cl>    print(chr(ord(c)-k),end = &#34;&#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(&#34;&#34;)
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{R0t@t10n_15_51mpl3_&amp;3ff3c71v3}</code></p><h3 id=numbers-2>Numbers 2</h3><p>8進数で表された文字コードです。数字に$8$以上が出現しないところに注目です。<code>sctf{0c74l_numb3r5_@r3_7h3_b3s7_w@y_70_3nc0d3_d@73}</code></p><h3 id=emoji-cipher>Emoji cipher</h3><p>「Kanji」と全く同じ解き方ができます。<code>sctf{3m0j1_com3_fr0m_j4pan}</code></p><h3 id=http>http</h3><p>URLエンコードです。<code>sctf{日本語でもok}</code></p><h3 id=sanity-check>Sanity Check</h3><p>日本人には読めないフォントElectroharmonixで書かれた文章です。注意深く見るとアルファベットが見えてきます。どうしても読めなければこのフォントのアルファベット表と比較しましょう。<code>SCTF{YOU_ARE_NOT_JAPANESE_LOL}</code></p><h3 id=numbers-3>Numbers 3</h3><p>15進数です。fが存在しないところに注目です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=s2>&#34;495c11db788574a62d038c125c688b9976c81c75370b9de35d1ac9da9a95b39591ea51cc3acd660b1804a44a743a443490826847dc9947d0c7067ed9dd7&#34;</span><span class=p>,</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{7h3_r4d1x_15_1mp0rtant_and_1m_5orry_ab0u7_7h15_pr0blem}</code>
酷い問題ですね(私は好きです)</p><h3 id=glitch>Glitch</h3><p>文字コードをうまい感じに扱うと解読できます</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>S</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;glitch.txt&#34;</span><span class=p>,</span><span class=s2>&#34;r&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;unicode_escape&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>T</span> <span class=o>=</span> <span class=n>S</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>T</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>T</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>T</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p><code>Unicode can be used to represent a wide variety of characters. One of them is the combining character system. Here is an example of a long flag: sctf{V0yag1ng_Thr0ugh_Th3_Unchart3d_Gl1tch3s_0f_Th3_C0sm0s_1n_Pursu1t_0f_H1dd3n_R3v3lat10ns_and_Unv34l1ng_th3_Myst3r13s_of_Th3_Unkn0wn_Un1v3rs3}</code></p><h3 id=zzzzzzzzzzzzzz>zzzzzzzzzzzzzz</h3><p>手抜き問題。暗号化スプリクトは以下の通りです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>shuffle</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>S</span> <span class=o>=</span> <span class=s2>&#34;sctf</span><span class=si>{h1d3_4nd_533k_j0yfu1_3xpl0r4t10n}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>T</span> <span class=o>=</span> <span class=s2>&#34;567f[HiDe-4nD-sEeK-JoyFUl-eXP1oRa7ioN]&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>S</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>F</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>18</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>F</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>S</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>17</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>F</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>T</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>shuffle</span><span class=p>(</span><span class=n>F</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>C</span> <span class=o>+=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>F</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>C</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ultimate-caesar>Ultimate Caesar</h3><p>線形変換を複数合成したその結果も線形変換です。例えば、$f(x) = 2x+5$と$g(x) = 3x+7$を合成すると、$g(f(x)) = g(2x+5) = 3(2x+5)+7 = 6x+22$となり、線形変換のままです。
さらに、この問題は$\pmod 65537$で計算しているので、線形変換$ax+b$の$a,b$はどちらも$0$以上$65536$以下の整数です。$a$を全探索し、1文字目が<code>s</code>となるような$b$を計算すれば、全通りの線形変換を試せます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mi>47799</span><span class=p>,</span> <span class=mi>18389</span><span class=p>,</span> <span class=mi>14535</span><span class=p>,</span> <span class=mi>725</span><span class=p>,</span> <span class=mi>21466</span><span class=p>,</span> <span class=mi>1781</span><span class=p>,</span> <span class=mi>25216</span><span class=p>,</span> <span class=mi>25632</span><span class=p>,</span> <span class=mi>37871</span><span class=p>,</span> <span class=mi>52855</span><span class=p>,</span> <span class=mi>39626</span><span class=p>,</span> <span class=mi>43890</span><span class=p>,</span> <span class=mi>63798</span><span class=p>,</span> <span class=mi>13679</span><span class=p>,</span> <span class=mi>28100</span><span class=p>,</span> <span class=mi>62877</span><span class=p>,</span> <span class=mi>55237</span><span class=p>,</span> <span class=mi>3163</span><span class=p>,</span> <span class=mi>35047</span><span class=p>,</span> <span class=mi>42930</span><span class=p>,</span> <span class=mi>18652</span><span class=p>,</span> <span class=mi>36817</span><span class=p>,</span> <span class=mi>49095</span><span class=p>,</span> <span class=mi>15836</span><span class=p>,</span> <span class=mi>31228</span><span class=p>,</span> <span class=mi>36576</span><span class=p>,</span> <span class=mi>11850</span><span class=p>,</span> <span class=mi>37110</span><span class=p>,</span> <span class=mi>38663</span><span class=p>,</span> <span class=mi>19959</span><span class=p>,</span> <span class=mi>38874</span><span class=p>,</span> <span class=mi>51360</span><span class=p>,</span> <span class=mi>15748</span><span class=p>,</span> <span class=mi>12843</span><span class=p>,</span> <span class=mi>57056</span><span class=p>,</span> <span class=mi>9250</span><span class=p>,</span> <span class=mi>32197</span><span class=p>,</span> <span class=mi>37439</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>l</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&#34;s&#34;</span><span class=p>))</span><span class=o>%</span><span class=n>l</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>d</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span><span class=o>%</span><span class=n>l</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>((</span><span class=n>p</span><span class=o>-</span><span class=n>d</span><span class=p>)</span><span class=o>%</span><span class=n>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>m</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;sctf{&#34;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>m</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&#34;}&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p>この問題を解くのに<code>params</code>は必要ありません。
<code>sctf{c0mp13x1ty_4nd_5urf1ng_7h3_w4v3s}</code></p><h2 id=basic-math>Basic Math</h2><p>数学(主に数論)に関する基本的な問題です。</p><h3 id=equation-1>Equation 1</h3><p>割り算するだけです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; 162030664//3158
</span></span><span class=line><span class=cl>51308
</span></span></code></pre></td></tr></table></div></div><h3 id=equation-2>Equation 2</h3><p>二分探索で求めます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># x^2</span>
</span></span><span class=line><span class=cl><span class=n>x2</span> <span class=o>=</span> <span class=mi>3386439659231533906596</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># xを2分探索で探す</span>
</span></span><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>x2</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>m</span> <span class=o>*</span> <span class=n>m</span> <span class=o>&gt;</span> <span class=n>x2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Pythonの標準である関数は誤差が出ることがあるため使わない方が良いです。</p><h3 id=equation-3>Equation 3</h3><p>同じく二分探索で求めます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x16</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># xを2分探索で探す</span>
</span></span><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>x16</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>m</span><span class=o>**</span><span class=mi>16</span> <span class=o>&gt;</span> <span class=n>x16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>l</span><span class=p>))</span> <span class=c1># sctf{r00t_of_unity}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=equation-4>Equation 4</h3><p>関数が単調増加であれば二分探索が使えます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=o>**</span><span class=mi>8</span> <span class=o>+</span> <span class=n>x</span><span class=o>**</span><span class=mi>4</span> <span class=o>+</span> <span class=n>x</span><span class=o>**</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fx</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># xを2分探索で探す</span>
</span></span><span class=line><span class=cl><span class=n>l</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>fx</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>f</span><span class=p>(</span><span class=n>m</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>fx</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>l</span><span class=p>))</span> <span class=c1># sctf{1ncr34s3_y0ur_5k1ll5}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=math-class-1>Math Class 1</h3><p>愚直に計算します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>sum</span><span class=p>([</span><span class=n>a</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2023</span><span class=o>+</span><span class=mi>1</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=mi>2047276</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=math-class-2>Math Class 2</h3><p>等差数列の和の公式を使います。
$10^{12}\times (10^{12}+1)/2 = 500000000000500000000000$</p><h3 id=math-class-3>Math Class 3</h3><p>下$10$桁は$10^{10}$で割った余りを求めれば良いです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>8128</span><span class=p>,</span><span class=mi>123456789</span><span class=p>,</span><span class=mi>10</span><span class=o>**</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>328442060</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=math-class-4>Math Class 4</h3><p>$x$の最大でも$157$未満なので、全探索できます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a = 29
</span></span><span class=line><span class=cl>b = 1
</span></span><span class=line><span class=cl>m = 157
</span></span><span class=line><span class=cl>for x in range(1,m):
</span></span><span class=line><span class=cl>    if (a*x)%m == b:
</span></span><span class=line><span class=cl>        print(x)
</span></span><span class=line><span class=cl>        break
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{65}</code></p><h3 id=math-class-5>Math Class 5</h3><p>ユークリッドの互除法を使います。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>GCD</span><span class=p>(</span><span class=n>b</span> <span class=o>%</span> <span class=n>a</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>14930888045225624011</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>8204203643581470607</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>))</span> 
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{3806516863}</code></p><h3 id=math-class-6>Math Class 6</h3><p>拡張ユークリッドの互助法で逆元を求めます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>inverse</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>m0</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>m</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>a</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>q</span> <span class=o>=</span> <span class=n>a</span> <span class=o>//</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>a</span> <span class=o>%</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>q</span> <span class=o>*</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>m0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>12345678</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>998244353</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>inverse</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>あるいは、今回はmodが素数なのでフェルマーの小定理を使っても解けます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>12345678</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>998244353</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>m</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span><span class=n>m</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{749734780}</code></p><h3 id=math-class-7>Math Class 7</h3><p>中国剰余定理を使います。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>crt</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># nx = 1 (mod m)</span>
</span></span><span class=line><span class=cl>    <span class=c1># my = 1 (mod n)</span>
</span></span><span class=line><span class=cl>    <span class=c1># anx + bmy は mでmで割ったあまりがa, nで割ったあまりがbになる</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#x = pow(n,-1,m)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>a</span> <span class=o>*</span> <span class=n>n</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>b</span> <span class=o>*</span> <span class=n>m</span> <span class=o>*</span> <span class=n>y</span><span class=p>)</span> <span class=o>%</span> <span class=p>(</span><span class=n>m</span> <span class=o>*</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>591233</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>950753</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>23</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=n>crt</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>m</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{549251909625}</code></p><h2 id=block-cipher>Block Cipher</h2><p>ブロック暗号に関する問題です。</p><h3 id=aes-starter>AES starter</h3><p>問題文の通りにやります。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Random</span> <span class=kn>import</span> <span class=n>get_random_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.strxor</span> <span class=kn>import</span> <span class=n>strxor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=mh>0xffffffffffffffffffffffffffffffff</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=mh>0x01230123012301230123012301230123</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=mh>0xf47fda4253994089ee89c8f0b76d3991d36c9085cb0ffaa06781fb56dd7fe9a4</span>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>enc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dec</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span><span class=o>.</span><span class=n>decrypt</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>unpad</span><span class=p>(</span><span class=n>dec</span><span class=p>(</span><span class=n>enc</span><span class=p>),</span> <span class=mi>16</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{iv_m34n5_f0ur}</code></p><h3 id=ecb-starter>ECB starter</h3><p>ECBモードは、16バイトごとに暗号化が独立しています。今回の暗号文は32バイトあるので、2ブロックに分けてそれぞれ復元すれば良いです。</p><ul><li><code>b6506e08641d53366fdbfa35e8549e24</code>をdecryptすると<code>736374667b4543425f69735f7430305f</code></li><li><code>d7666bdf3cbad130ddeb8eb1d0c7b58a</code>をdecryptすると<code>7765616b7d0b0b0b0b0b0b0b0b0b0b0b</code></li><li>これらを繋げて16進数デコードすると<code>sctf{ECB_is_t00_weak}</code></li></ul><p>他にも、暗号文を余分に伸ばして回避する方法もあります。</p><h3 id=ofb-starter>OFB starter</h3><p>OFBモードは暗号化と復号がブロックごとで同じ操作です。
よって、次のようにして復号できます。</p><ul><li>適当な<code>iv</code>を用意(例えば<code>00000000000000000000000000000000</code>)してdecryptして<code>0e1e6412ca1533f9681c64b68dc8817e85c7508d4a3d6ee0570cf4b53adf723102</code></li><li><code>0e1e6412ca1533f9681c64b68dc8817e85c7508d4a3d6ee0570cf4b53adf723102</code>をもう一度decryptすると<code>736374667b57307264355f756e6c33347368316e675f637233347431763174797d7a3cd23dca7751c2491347e7e264fd76747220244d2c8b26d2373a583913096fcb</code></li><li>デコードすると<code>sctf{W0rd5_unl34sh1ng_cr34t1v1ty}</code></li></ul><h3 id=cbc-starter>CBC starter</h3><p>まず、暗号文を16バイトごとに分割します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>958fd2d255b337bb0c3d8c95fbcbc56a
</span></span><span class=line><span class=cl>6793aad6cb36a4c9bbc6bfc1791ac3f0
</span></span><span class=line><span class=cl>dc5b1476371e1333927ebdbc9d2ab27f
</span></span></code></pre></td></tr></table></div></div><ul><li>はじめの16バイトを与えられた<code>iv</code>を使ってdecryptすると<code>sctf{d1sc0v3r1ng</code>が得られます。</li><li>次の16バイトは、<code>iv</code>を<code>958fd2d255b337bb0c3d8c95fbcbc56a</code>にすれば<code>_CBC_m0d3_1n_cr1</code>が得られます。</li><li>最後の16バイトは、<code>iv</code>を<code>6793aad6cb36a4c9bbc6bfc1791ac3f0</code>にすれば<code>pt0}</code>が得られます。</li></ul><p>よって、フラグは<code>sctf{d1sc0v3r1ng_CBC_m0d3_1n_cr1pt0}</code>です。</p><h3 id=padding-escapade>Padding Escapade</h3><p>コードは次のように暗号化しています</p><ul><li>フラグの長さを$L$として、$i=1,2,\dots,L$に対して、次を行う<ul><li><code>i</code>文字目までを16バイトの倍数になるようにパディングし、<code>enc</code>配列に追加</li><li>フラグの先頭<code>i</code>文字目にランダムな8bitをxor</li></ul></li><li><code>enc</code>の順序をシャッフルして出力</li></ul><p>そもそも、paddingという操作は「データを16の倍数バイトの長さに延長する」という操作ですが、unpaddingという操作によって、「16の倍数バイトのデータを元の状態に戻す」ことができます(paddingという操作によって、元の長さの情報は失われていないのです)。
ですから、unpaddingをすればその文字列の長さから何文字目の情報であるかがわかります。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>getrandbits</span><span class=p>,</span> <span class=n>sample</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc</span> <span class=o>=</span> <span class=c1># 省略</span>
</span></span><span class=line><span class=cl><span class=n>ct</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>enc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ct</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># unpad</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>ct</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>unpad</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{Unpadd1ng_1s_un1que1y_def1n3d}</code></p><h3 id=format-detection>Format Detection</h3><p>CBCモードのdecryptの手順を見ると、最初の16バイトは最後に<code>iv</code>をxorしていることがわかります。最後のxorをこちら側でやってしまえばよいです。次の手順で解きます。</p><ul><li>暗号文を<code>iv</code>を<code>00000000000000000000000000000000</code>としてdecryptすると<code>eafafcee0c030e554e6316135d5174335f316e5f7468335f736b377d04040404</code>が得られる。<ul><li>後半16バイトをデコードするとフラグの一部<code>_1n_th3_sk7}</code>が得られる。</li></ul></li><li>前半16バイトを<code>iv</code>の<code>99998888777766661111222233334444</code>とxorを取ることで、<code>736374667b7468335f7234316e623077</code>になり、デコードすると<code>sctf{th3_r41nb0w</code>が得られる。</li></ul><p>よって、フラグは<code>sctf{th3_r41nb0w_1n_th3_sk7}</code>です。</p><h2 id=modern-crypto>Modern Crypto</h2><p>現代暗号に関連する問題です。CTFのCrypto問題の多くは、このカテゴリに属します。</p><h3 id=xor-starter>XOR starter</h3><p><code>key</code>が暗号化スクリプトに直書きされています(多分普通にミス)ので、それを使って復号します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mi>66</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>87</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>126</span><span class=p>,</span> <span class=mi>99</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>86</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>84</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>69</span><span class=p>,</span> <span class=mi>88</span><span class=p>,</span> <span class=mi>84</span><span class=p>,</span> <span class=mi>66</span><span class=p>,</span> <span class=mi>76</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span> <span class=o>^</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;sctf&#34;</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{XOR_has_int3r3sting_pr0perties}</code></p><h3 id=xor-maze>XOR Maze</h3><p>式の上から順に$a,b,c,d$とすると、</p><ul><li>$c \oplus d = C$</li><li>$b \oplus (c \oplus d) = b \oplus C = A\oplus B \oplus C \oplus D$</li><li>$a \oplus (b \oplus (c \oplus d)) = a \oplus A\oplus B \oplus C \oplus D = x$</li></ul><p>よって、$a\oplus b\oplus c\oplus d$を計算すれば良いです。<code>sctf{XOR-XOR-XOR}</code></p><h3 id=xor-xor-xor>XOR XOR XOR</h3><p>暗号化した結果をそのまま16進数デコードすると<code>sctf{Par17y_15_an_imp0rt4n7_prop3rty}</code>が得られます。つまり暗号化しているように見えて、何も変化していません。</p><p>これは、$0$から$2^32-1$を$2$進数にしたときに、各ビットで必ず偶数回1が出現していることによります。</p><h3 id=foresight-14>Foresight? 1～4</h3><p>Foresight? 4は他の問題を包含しているめ、それを解くコードだけ載せます。理論の説明は<a class=link href=https://shibaken28.github.io/my-blog-4/contents/randomness/ target=_blank rel=noopener>線形合同法のパラメータ推測</a>を参照してください。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>linear_random_crack</span><span class=p>(</span><span class=n>rands</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=p>[</span><span class=n>rands</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>rands</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>rands</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=p>[(</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>*</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=o>-</span><span class=mi>2</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>((</span><span class=n>t</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>m</span><span class=p>))</span><span class=o>%</span><span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>rands</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>rands</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>%</span><span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=mi>747295850</span><span class=p>,</span> <span class=mi>164867235</span><span class=p>,</span> <span class=mi>2576857841</span><span class=p>,</span> <span class=mi>3363332730</span><span class=p>,</span> <span class=mi>1094604011</span><span class=p>,</span> <span class=mi>2843336746</span><span class=p>,</span> <span class=mi>1656975446</span><span class=p>,</span> <span class=mi>397591104</span><span class=p>,</span> <span class=mi>3296405267</span><span class=p>,</span> <span class=mi>3516873680</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=p>[</span><span class=mi>44926602</span><span class=p>,</span> <span class=mi>2937937393</span><span class=p>,</span> <span class=mi>174436646</span><span class=p>,</span> <span class=mi>2491180612</span><span class=p>,</span> <span class=mi>315256230</span><span class=p>,</span> <span class=mi>3211193071</span><span class=p>,</span> <span class=mi>568689060</span><span class=p>,</span> <span class=mi>93639370</span><span class=p>,</span> <span class=mi>1909387862</span><span class=p>,</span> <span class=mi>3075542788</span><span class=p>,</span> <span class=mi>1540942839</span><span class=p>,</span> <span class=mi>198180033</span><span class=p>,</span> <span class=mi>727016228</span><span class=p>,</span> <span class=mi>2502033293</span><span class=p>,</span> <span class=mi>1802750036</span><span class=p>,</span> <span class=mi>569086897</span><span class=p>,</span> <span class=mi>375047049</span><span class=p>,</span> <span class=mi>1629464891</span><span class=p>,</span> <span class=mi>1407370985</span><span class=p>,</span> <span class=mi>477707872</span><span class=p>,</span> <span class=mi>774404513</span><span class=p>,</span> <span class=mi>2716137718</span><span class=p>,</span> <span class=mi>1840779688</span><span class=p>,</span> <span class=mi>1191662382</span><span class=p>,</span> <span class=mi>3504379912</span><span class=p>,</span> <span class=mi>748125320</span><span class=p>,</span> <span class=mi>1658575995</span><span class=p>,</span> <span class=mi>928538355</span><span class=p>,</span> <span class=mi>3070989414</span><span class=p>,</span> <span class=mi>2468916650</span><span class=p>,</span> <span class=mi>2782012797</span><span class=p>,</span> <span class=mi>610961179</span><span class=p>,</span> <span class=mi>3682269712</span><span class=p>,</span> <span class=mi>2770385176</span><span class=p>,</span> <span class=mi>2785363482</span><span class=p>,</span> <span class=mi>1486741234</span><span class=p>,</span> <span class=mi>2524249046</span><span class=p>,</span> <span class=mi>1721210836</span><span class=p>,</span> <span class=mi>3665494948</span><span class=p>,</span> <span class=mi>2796298560</span><span class=p>,</span> <span class=mi>431561753</span><span class=p>,</span> <span class=mi>2330491191</span><span class=p>,</span> <span class=mi>2141216717</span><span class=p>,</span> <span class=mi>3524354070</span><span class=p>,</span> <span class=mi>1129782399</span><span class=p>,</span> <span class=mi>3057714851</span><span class=p>,</span> <span class=mi>2038862641</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>m</span> <span class=o>=</span> <span class=n>linear_random_crack</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cipher</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span> <span class=o>^</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=n>b</span><span class=p>)</span><span class=o>%</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=n>b</span><span class=p>)</span><span class=o>%</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>これを使うと、各問題のフラグは</p><ul><li>1: <code>sctf{1_0f_th3_w0r$t_rand0m_numb3r_g3n3r@tor5}</code></li><li>2: <code>sctf{d0_n0t_u5e_l1near_c0n9ruent1al_gener@t0r5}</code></li><li>3: <code>sctf{l1near_c0n9ruent1al_gener@t0r_is_n0t_5@fe}</code></li><li>4: <code>sctf{b3_c4r3ful_w1th_l1n34r_c0ngru3nti4l_g3n3r4t0r}</code></li></ul><h3 id=foresight-final>Foresight? Final</h3><p>一つ飛ばしの場合、漸化式が$x_{n+2} = ax_{n+1} + b = a^2 x_n + ab + b$となります。新たに$A=a,B=ab+b$とおけば、$x_{n+2} = Ax_n + B$となり、これはForesight? 4と同じ問題になります。</p><p>$A,B$、そしてmodの$m$が求まれば、あとは$A=a^2,B=ab+b$を解けば良いですが、ここで注意なのはこの方程式は$\mod m$で解く必要があることです。$a$を$A$からもとめるには、modの世界で平方根を取る必要があります。</p><p>今回は、$m=3 \pmod 4$であるため、$A^{\frac{m-3}{4}}$の逆元が$A$の平方根になります。
(そうでない場合はこの手順では求められませんが、別のアルゴリズムを用いることで求めることはできます。Cipolla&rsquo;s algorithmや、Tonelli-Shanks algorithmなどがあります。)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mod_root</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>p</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># x^2 = a mod pとなるようなxを返す</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=n>p</span><span class=o>%</span><span class=mi>4</span> <span class=o>==</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>3</span><span class=p>)</span><span class=o>//</span><span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>p</span><span class=p>),</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=p>(</span><span class=n>x</span><span class=o>**</span><span class=mi>2</span> <span class=o>%</span> <span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>linear_random_crack</span><span class=p>(</span><span class=n>rands</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=p>[</span><span class=n>rands</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>rands</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>rands</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=p>[(</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>*</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=o>-</span><span class=mi>2</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>((</span><span class=n>t</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>t</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>m</span><span class=p>))</span><span class=o>%</span><span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>rands</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>rands</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=o>%</span><span class=n>m</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span><span class=p>,</span><span class=n>B</span><span class=p>,</span><span class=n>m</span> <span class=o>=</span> <span class=n>linear_random_crack</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>mod_root</span><span class=p>(</span><span class=n>A</span><span class=p>,</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>B</span><span class=o>*</span><span class=n>inverse</span><span class=p>(</span><span class=n>a</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=n>m</span><span class=p>)</span><span class=o>%</span><span class=n>m</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cipher</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span> <span class=o>^</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=n>b</span><span class=p>)</span><span class=o>%</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>+</span><span class=n>b</span><span class=p>)</span><span class=o>%</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{th3_s33r_0f_b3y0nd_c4n_p3rceiv3_th3_1nvis1bl3}</code></p><h3 id=modular-puzzle>Modular Puzzle</h3><p>modはとりあえず無視します。この問題の趣旨は次のとおりです。</p><ul><li>$v=g(a^2+b^2+c^2)$を次の値から求める<ul><li>$s=gab$</li><li>$t=gbc$</li><li>$u=gca$</li></ul></li></ul><p>次のように求めることができます。</p><ul><li>$ga^2 = st^{-1}u$</li><li>$gb^2 = stu^{-1}$</li><li>$gc^2 = s^{-1}tu$</li><li>よって、$v = g(s^{-1}tu + st^{-1}u + stu^{-1}) = stu(s^{-2}+t^{-2}+u^{-2})$</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>getrandbits</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>b</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=n>u</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=n>ct</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>s</span> <span class=o>*</span> <span class=n>t</span> <span class=o>*</span> <span class=n>u</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl><span class=n>gc2</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ga2</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>gb2</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>v</span> <span class=o>=</span> <span class=p>(</span><span class=n>ga2</span> <span class=o>+</span> <span class=n>gb2</span> <span class=o>+</span> <span class=n>gc2</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>ct</span><span class=p>,</span> <span class=nb>pow</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>),</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sctf{unv34lin9_th3_p0w3r_0f_m0dul4r_1nv3rs3s_1n_crypt0}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=exphash>ExpHash</h3><p>長さ$1000$の配列が$4$つ与えられているので、全パターン試すと$10^{12}$通りになります。これは計算に時間がかかるので
高速な次のようなアルゴリズムを使います。求めたいパスワードのハッシュ値を$h$とします。</p><ul><li><code>list1</code>と<code>list2</code>の全組み合わせのハッシュを計算して<code>dict1</code>に保存</li><li><code>list3</code>と<code>list4</code>の全組み合わせのハッシュを計算して<code>dict2</code>に保存</li></ul><p>ここで、重要な次の性質を使います。</p><ul><li>長さ$N$の文字列$s$と文字列$t$のハッシュ値がそれぞれ$h_s,h_t$であるとすると、連結した文字列$s+t$のハッシュ値は$h_s + h_t \times base^{N} $となる</li></ul><p>これにより、<code>dict2</code>の全ての要素$h_2$について次の問題を解きます。</p><ul><li>$h_1+base^N \times h_2 = h$が成り立つ$h_1$を求める。<ul><li>$h_1 = h - base^N \times h_2$</li></ul></li><li>$h_1$が<code>dict1</code>に存在するかを調べる</li></ul><p>適切なデータ構造(プログラム上では<code>dict</code>を使用)を使うことで上記の操作は$O(\log 10^6)$で行うことができます。
よって、この問題は、$X=10^3$とすると、$O(X^2 \log X^2)$で解くことができました。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>base</span> <span class=o>=</span> <span class=mi>48337</span>
</span></span><span class=line><span class=cl><span class=n>mod</span> <span class=o>=</span> <span class=mi>11135515903660432429</span>
</span></span><span class=line><span class=cl><span class=n>list1</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;NveEp&#39;</span><span class=p>,</span> <span class=c1># 省略</span>
</span></span><span class=line><span class=cl><span class=n>list2</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;6nBxk&#39;</span><span class=p>,</span> <span class=c1># 省略</span>
</span></span><span class=line><span class=cl><span class=n>list3</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;fls3N&#39;</span><span class=p>,</span> <span class=c1># 省略</span>
</span></span><span class=line><span class=cl><span class=n>list4</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;TLpkV&#39;</span><span class=p>,</span> <span class=c1># 省略</span>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>=</span> <span class=mi>10560284356650745449</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>base</span><span class=p>,</span> <span class=n>mod</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=o>=</span> <span class=p>(</span><span class=n>ret</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>mod</span><span class=p>))</span> <span class=o>%</span> <span class=n>mod</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dict34</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>s3</span> <span class=ow>in</span> <span class=n>list3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>s4</span> <span class=ow>in</span> <span class=n>list4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=nb>hash</span><span class=p>(</span><span class=n>s3</span> <span class=o>+</span> <span class=n>s4</span><span class=p>,</span> <span class=n>base</span><span class=p>,</span> <span class=n>mod</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=n>mod</span><span class=p>))</span> <span class=o>%</span> <span class=n>mod</span>
</span></span><span class=line><span class=cl>        <span class=n>dict34</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>=</span> <span class=n>s3</span> <span class=o>+</span> <span class=n>s4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>s1</span> <span class=ow>in</span> <span class=n>list1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>s2</span> <span class=ow>in</span> <span class=n>list2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=p>(</span><span class=n>h</span> <span class=o>-</span> <span class=nb>hash</span><span class=p>(</span><span class=n>s1</span> <span class=o>+</span> <span class=n>s2</span><span class=p>,</span> <span class=n>base</span><span class=p>,</span> <span class=n>mod</span><span class=p>))</span> <span class=o>%</span> <span class=n>mod</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>l</span> <span class=ow>in</span> <span class=n>dict34</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>s1</span> <span class=o>+</span> <span class=n>s2</span> <span class=o>+</span> <span class=n>dict34</span><span class=p>[</span><span class=n>l</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=nb>hash</span><span class=p>(</span><span class=n>s1</span> <span class=o>+</span> <span class=n>s2</span> <span class=o>+</span> <span class=n>dict34</span><span class=p>[</span><span class=n>l</span><span class=p>],</span> <span class=n>base</span><span class=p>,</span> <span class=n>mod</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sctf{xYDpuEYEeO8m5ZQxkmO5}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=staircase>Staircase</h3><p>問題ファイルの<code>verify</code>関数を使おうとすると、実行に非常に時間がかかってしまうので、別の方法を考えます。</p><p>問題ファイルの<code>verify(a)</code>関数では、<code>a-1</code>の階乗が<code>a</code>で割り切れるかどうかを判定しています。
この判定は、<code>a</code>が素数であるかどうかと同値です。なぜなら、</p><ul><li>$a$が素数ではない場合を考える</li><li>$a=p_1^{e_1}p_2^{e_2}\dots p_k^{e_k}$と素因数分解できるとする</li><li>$s = \lbrace p_1^{e_1}, p_2^{e_2}, \dots, p_k^{e_k} \rbrace $とすると、$s$の全要素の積は$a$である。</li><li>一方、$(a-1)!$は、$a$以下の全ての数の積であり、$s$の各要素は全て$a-1$以下であるため、$(a-1)!$は$s$の全要素の積で割り切れる。</li></ul><p>という理由によります(簡単に言うと、$a$が合成数だったら$a$の約数が$1$から$a-1$の間に存在するよね、ということです)。</p><p>より詳しく知りたい場合は<a class=link href=https://mathlandscape.com/wilson-theorem/ target=_blank rel=noopener>ウィルソンの定理</a>を御覧ください。</p><p>よってこの問題は、素数判定を$O(N)$から$O(\sqrt N)$に高速化することで解くことができます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>isPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>isPrime</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>a</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>verify</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sctf{unl0cking_th3_myst3r13s_0f_f4ct0ri4ls_4nd_th3ir_3xtr4ordinary_pr0p3rt13s}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=smidgen>Smidgen</h3><p>$2^x$の上位$7$桁のみが与えられて、$x$を求める問題です。$x$が大きくなると桁数が大きくなり計算に非常に時間がかかるため、$\log$をうまく使って、上位7桁<strong>のみ</strong>求められないかを考えます。
以下、$\log$の底は$10$とします。</p><p>例えば、$1.234567 \times 10^{100}$という数は、上位$7$桁が$1234567$となります。これを対数で表すと、
$$
\begin{align}
\log(1.234567 \times 10^{100}) &= \log(1.234567) + \log(10^{100}) \\
&= \log(1.234567) + 100\log(10) \\
&= 100 + \log(1.234567)
\end{align}
$$
となります。$\log(1.234567)&lt;1$ですので、対数を取った値の小数部分に各桁の情報が入っています。よって、
$$
10^{\log(1.234567)} = 1.234567
$$
と累乗を行うと、数字の復元ができます。</p><p>このように、$2^x = a \times 10^b$と考えれば、$\log(2^x) = \log(a) + b\log(10)$となり、$10^{\log(a)}$の小数点以下6桁までが、$2^x$の上位$7$桁と一致します。</p><p>pythonの<code>log10</code>関数の精度が気になりますが、今回は小数点以下6桁まで求めれば十分ですので、問題ありません。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=n>log10</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=s2>&#34;1873119&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2^x の 上から7桁</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>top7</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>x</span> <span class=o>*</span> <span class=n>log10</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># aの小数部分を取り出す</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>a</span> <span class=o>-</span> <span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 10^b を求める</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=mi>10</span> <span class=o>**</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=c1># 10^b の上から7桁を求める</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>c</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>**</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>str</span><span class=p>(</span><span class=n>top7</span><span class=p>(</span><span class=n>x</span><span class=p>))</span> <span class=o>==</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># break</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=c1># PIN</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=rsa-starter>RSA starter</h3><p>やるだけです。RSAの説明はネットに山ほどあるので省略します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sctf{A_good_start}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=each-rsa>Each RSA</h3><p>$1$文字ずつ暗号化されているということは、各平文$m_i$は高々$128$以下の数であることがわかります。$x^e = c_i \pmod n$となるような$x$を全探索すれば良いです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>cs</span> <span class=o>=</span> <span class=p>[</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>c</span><span class=o>==</span><span class=nb>pow</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># sctf{it_is_sunday}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=small-rsa>Small RSA</h3><p>$e$が小さく$m^e &lt; n $となっていると予想できます。実際に$3$乗根を取ると、平文が得られます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>iroot</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=n>e</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># sctf{this_looks_#short}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=rush-e>RUSH E</h3><p>$100$回暗号化しているだけなので$100$回復号すれば良いです。ちなみに$(a^x)^y=(a^y)^x$なので$e$の順番はなんでも良いです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>E</span> <span class=o>=</span> <span class=p>[</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=n>p</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>E</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>),</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>c</span><span class=p>))</span> <span class=c1># sctf{Enigma_0f_Ethereal_Expl0ration}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2d-lagrange>2D Lagrange</h3><p>$a,b,c$のうち、2つの値が求まれば残りの一つは定まります。次のソースコードでは$b,c$を全探索しています。
$a,b,c$が決定すれば、2次方程式になるので、解の公式や二分探索で解けます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>function</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>b</span><span class=o>*</span><span class=n>x</span> <span class=o>+</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=mi>2911</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=mi>8337062002</span>
</span></span><span class=line><span class=cl><span class=n>ct</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>y</span> <span class=o>-</span> <span class=n>b</span><span class=o>*</span><span class=n>x</span> <span class=o>-</span> <span class=n>c</span><span class=p>)</span><span class=o>//</span><span class=p>(</span><span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>function</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>x</span><span class=p>)</span> <span class=o>!=</span> <span class=n>y</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 二分探索で，f(x) = ctとなるxを求める</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>ct</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>r</span> <span class=o>-</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=n>r</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>function</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>m</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=n>ct</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>r</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>l</span> <span class=o>=</span> <span class=n>m</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>function</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>r</span><span class=p>)</span> <span class=o>==</span> <span class=n>ct</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>function</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>,</span><span class=n>x</span><span class=p>)</span> <span class=o>==</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>r</span><span class=p>))</span> <span class=c1># sctf{brute_force_is_not_so_bad}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=common-n-rsa>Common N RSA</h3><p>$e_1, e_2$が互いに素であることから、$e_1x + e_2y = 1$となるような$x,y$が存在します。
そのような$x,y$を求め、$c_1^x \times c_2^y = m^{e_1x+e_2y} = m$となるので、$m$が求まります。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>inverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>135879330917823239005274526173902941241</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>110581307957357787004164255007822749852</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>egcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>x</span> <span class=o>=</span> <span class=n>egcd</span><span class=p>(</span><span class=n>b</span> <span class=o>%</span> <span class=n>a</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>x</span> <span class=o>-</span> <span class=p>(</span><span class=n>b</span> <span class=o>//</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>y</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>g</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>egcd</span><span class=p>(</span><span class=n>e1</span><span class=p>,</span><span class=n>e2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>n</span><span class=p>)</span><span class=o>*</span><span class=nb>pow</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>n</span><span class=p>)</span><span class=o>%</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{C0mm0n_N_15_0n3_0f_7h3_m057_345y_7o_f@c70r1z3_pr1m3_f@c70r5}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=many-rsa>Many RSA</h3><p>素数が$9$個しか用意されていないのに、$5$回の暗号化、すなわち$10$個の素数を使っているということは、
必ずある$n_i$と$n_j$が同じ素数を使っていることになります。よって、$n_i$と$n_j$の最大公約数を求めることで、ある素数$p$が求まります。
$i,j$は全探索すればよいです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span>  <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span>  <span class=p>[</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span>  <span class=p>[</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>GCD</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>GCD</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>n</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>GCD</span><span class=p>(</span><span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>n</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span> <span class=o>=</span> <span class=n>GCD</span><span class=p>(</span><span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>n</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>q</span> <span class=o>=</span> <span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>//</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>            <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{GCD_15_50_useful_in_m4th_4nd_cryp70_!}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=unbalance-rsa>Unbalance RSA</h3><p>$n=p_1,p_2,\dots,p_k$のうち、$p_1,p_2,\dots,p_x ( x&lt;k ) $だけが求まったとき、
$n^\prime = p_1p_2\dots p_x>m$であれば$n^\prime$を使って復号できます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>factor</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=mi>24</span><span class=p>,</span> <span class=mi>1</span><span class=o>&lt;&lt;</span><span class=mi>26</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>n</span> <span class=o>%</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>//=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ps</span> <span class=o>=</span> <span class=n>factor</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>ps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>*=</span> <span class=n>p</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>*=</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{sti11_we4k_rs@}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=cutrsa>CutRSA</h3><p>$p,q$それぞれ$1024$うち、$p$は上位$512$bit、$q$は下位$512$bitだけわかっています。</p><ul><li>$n$の下位$1$bitは、$p$と$q$の下位$1$bitの積です。よって、$q$の下位$1$ビットがわかっているため、$p$の下位$1$bitが求まります。</li><li>$n$の下位$2$bitは、$p$と$q$の下位$2$bitの積です。よって、$q$の下位$2$ビットと$p$の下位$1$bitがわかっているため、$p$の下位$2$bitが求まります。</li><li>以下同様に、$p$の下位$512$bitが求まります。</li></ul><p>$p$が分かれば、$q$は$n/p$で求まります。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sはpの上位$512$bitとqの下位$512$bitを結合したもの</span>
</span></span><span class=line><span class=cl><span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=mi>512</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>s</span> <span class=o>&amp;</span> <span class=n>mask</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span> <span class=o>&gt;&gt;</span> <span class=mi>512</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>512</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># pの下位ビットから決定していく</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>512</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>p</span><span class=o>*</span><span class=n>q</span><span class=p>)</span> <span class=o>%</span> <span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>))</span> <span class=o>==</span> <span class=n>n</span> <span class=o>%</span> <span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>+=</span> <span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>n</span> <span class=o>//</span> <span class=n>p</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>p</span><span class=o>*</span><span class=n>q</span> <span class=o>==</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>phi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{CUT_i5_@_U53FUL_L1NUX_C0MM@ND}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=insufficient-rsa>Insufficient RSA</h3><p><strong>求まるフラグがダミーのもの(<code>flag{????????????????}</code>みたいな文字列)になってしまうという問題の不備があります(要修正)</strong></p><p>$m^{e_1e_2}$に$m^{e_1}$の逆元を掛け算していくと、
$$
\begin{align}
m^{e_1e_2} \times m^{-e_1} &= m^{e_1e_2 - e_1} \\
&= m^{e_1(e_2 - 1)} \\
m^{e_1e_2}\times m^{-2e_1} &= m^{e_1(e_2 - 2)} \\
\dots \\
m^{e_1e_2} \times m^{-ke_1} &= m^{e_1(e_2 - k)} \\
\end{align}
$$
$k$が$e_2-1$になったときに、$m^{e_1e_2} \times m^{-ke_1} = m^{e_1}$が成り立ちます。今回$e_2$はそこまで大きくないため、$k$を順に試していけば、$m^{e_2}$が求まります。</p><p>同じ手順を使えば、$m^{e_1}$も求まります。$e_1,e_2$が求まれば、あとはCommon N RSAと同じです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=n>c3</span> <span class=o>=</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># c1:m^e1 mod n</span>
</span></span><span class=line><span class=cl><span class=c1># c2:m^e2 mod n</span>
</span></span><span class=line><span class=cl><span class=c1># c3:m^(e1*e2) mod n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c1i</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>c4</span> <span class=o>=</span> <span class=n>c3</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>c4</span> <span class=o>!=</span> <span class=n>c1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>c4</span> <span class=o>=</span> <span class=p>(</span><span class=n>c1i</span> <span class=o>*</span> <span class=n>c4</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c2i</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>c4</span> <span class=o>=</span> <span class=n>c3</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>c4</span> <span class=o>!=</span> <span class=n>c2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>c4</span> <span class=o>=</span> <span class=p>(</span><span class=n>c2i</span> <span class=o>*</span> <span class=n>c4</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>egcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>x</span> <span class=o>=</span> <span class=n>egcd</span><span class=p>(</span><span class=n>b</span> <span class=o>%</span> <span class=n>a</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>x</span> <span class=o>-</span> <span class=p>(</span><span class=n>b</span> <span class=o>//</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>y</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>g</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span><span class=n>b</span> <span class=o>=</span> <span class=n>egcd</span><span class=p>(</span><span class=n>e1</span><span class=p>,</span><span class=n>e2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=p>(</span><span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>n</span><span class=p>)</span><span class=o>*</span><span class=nb>pow</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>n</span><span class=p>))</span> <span class=o>%</span><span class=n>n</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># </span>
</span></span></code></pre></td></tr></table></div></div><h3 id=everyone>@Everyone</h3><p>共通の$m,e$と異なる$n$に対するデータを複数得られる場合に使えるHastad Broadcast Attackをします。</p><p>$k$個の$c_i = m^e \pmod {n_i}$を満たす値の組$(n_i,c_i)$と$e$が与えられたとします。
これは、$m^e$に対して、中国剰余定理(Math Class 7を参照)の問題と一致しますので、次の条件を満たす$x$を求めることができます(簡単のため、全ての$n_i$が互いに素であるとします)。</p><p>$$
x = m^e \pmod {n_1n_2\dots n_k}
$$</p><p>このとき、$e\leq k$である場合、全ての$i$について$m&lt;n_i$ですから、$m^e &lt; n_1n_2\dots n_k$となり、単純に$x$の$e$乗根を取ることで、$m$が求まります。</p><p>今回の問題では、$e=11$の場合の$n$が$11$個以上得られるので、$e=11$のものだけを使って、Hasatd Broadcast Attackを行います。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pub</span> <span class=o>=</span> <span class=p>[(</span><span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>x = dict()
</span></span></span><span class=line><span class=cl><span class=s2>x[7] = 0
</span></span></span><span class=line><span class=cl><span class=s2>x[11] = 0
</span></span></span><span class=line><span class=cl><span class=s2>x[13] = 0
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>for n,e,c in pub:
</span></span></span><span class=line><span class=cl><span class=s2>    # eを数える
</span></span></span><span class=line><span class=cl><span class=s2>    x[e] += 1
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># e = 11のときのみ使う</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>crt</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># nx = 1 (mod m)</span>
</span></span><span class=line><span class=cl>    <span class=c1># my = 1 (mod n)</span>
</span></span><span class=line><span class=cl>    <span class=c1># anx + bmy は mでmで割ったあまりがa, nで割ったあまりがbになる</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#x = pow(n,-1,m)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>a</span> <span class=o>*</span> <span class=n>n</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>b</span> <span class=o>*</span> <span class=n>m</span> <span class=o>*</span> <span class=n>y</span><span class=p>)</span> <span class=o>%</span> <span class=p>(</span><span class=n>m</span> <span class=o>*</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>multi_crt</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>M</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>A</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>A</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>M</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>M</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>A</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=n>M</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>A</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>crt</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>n</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>M</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>m</span> <span class=o>*</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>multi_crt</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>n</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>c</span> <span class=ow>in</span> <span class=n>pub</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>e</span> <span class=o>==</span> <span class=mi>11</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>C</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>N</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e11</span><span class=p>,</span> <span class=n>M</span> <span class=o>=</span> <span class=n>multi_crt</span><span class=p>(</span><span class=n>C</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>iroot</span><span class=p>(</span><span class=n>e11</span><span class=p>,</span> <span class=mi>11</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># sctf{th3_unbr34k4bl3_v01c3_0f_h4st4d_br0adc4st_4tt4ck_unv34l1ng_th3_h1dd3n_s3cr3ts_0f_cr1pt0syst3ms}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=hyperdefensiveness>Hyperdefensiveness</h3><p>$k,b$がランダムな数で、各文字$m_i$について$(2^km_i+b)$が暗号化されています。$k$は$512$未満なので全探索可能ですが、$b$は$n$以下と非常に範囲が広いです。</p><p>フラグの初めの二文字は<code>sc</code>であるとわかっているため、この情報が利用できないかを考えます。つまり、既知の$m_1,m_2,c_1,c_2,e,k,n$について($k$は全探索するので便宜上既知であるとする)、次の式を満たすような$b$を求めたいです。</p><p>$$
\begin{align}
(2^km_1+b)^e &= c_1 \pmod n \\
(2^km_2+b)^e &= c_2 \pmod n
\end{align}
$$</p><p>変形すると、
$$
\begin{align}
f(b) &= (2^km_1+b)^e - c_1 \pmod n \\
g(b) &= (2^km_2+b)^e - c_2 \pmod n
\end{align}
$$</p><p>という$2$つの多項式が$0$となるような$b$、すなわち根を求める問題になります。このような問題は、多項式の最大公約数を求めることで解くことができます(Franklin-Reiter&rsquo;s Related Message Attackと呼ぶ)。</p><p>多項式の計算は<code>sagemath</code>に任せると便利です。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>111514100148774326367705704736979222700401163624613214832624545719172770237899669582747006984030817853537084997757295711771232132521914358653635342045379037331503674931338739346404124271446163845765651229207102076432601166326800350688722515916583372070523688695222758956481368503534557433446349136015628686357</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>cs</span> <span class=o>=</span> <span class=p>[</span><span class=mi>36267140803452927179495057268448637938138995328162738572087076174220240409292283541262772017889475150655158065847142060266322895790122174113706941494516841596254131235045666942402107201191704864689684087893142094789041848673700495337259457092014502960338636410206960779545493988287354582365176480889241401397</span><span class=p>,</span> <span class=mi>84177014604944804713431824977078430985039214840423548727302549935407939656001979736935056882466843836602458913229420653818014792087210619568737881610552000458150387886315505969718562202068244042324330912044030393635010283562361328009574502508818702705813189169328775333079963347257257925439630420220127175829</span><span class=p>,</span> <span class=mi>26334588403552340607768398401306649416040755108588686852906416781666048381323771223923748405041710715559064788598428283647378768153915565669694911025250778622002628864868653682135547573138160585696497105672184318572016275402944765554398056054008792299636594593784891344328744192547814256637485325927317001395</span><span class=p>,</span> <span class=mi>39008748355038168689186112775415171775080453538840696392929415443773790351994722271571121500900391631955057916363561421994355312684103960195488880752606720853798798281056868691805850650791447036298961423811854772591007911280152475310164832965003512721252819160190892144211679158575822375393777439609931384228</span><span class=p>,</span> <span class=mi>82304474098043608661060028321681382334401394934904222339395319421383234876718900465268919670376069360510194518855949296211410738852781393673645359310632298617613158767343280562908595925412679114315777637952825196478714760929249924083956743233566407955764435141409334579687138596172519820900979765467753196573</span><span class=p>,</span> <span class=mi>88915284105550368348816008646608742292143489029127610126933206845483111178644891122256082598282559325036353326973664929069944575618690996757635254147026094139437865194750539450473269922090279864309652543519451590611102139707332820460670115266911755768845241843718195465579759746419873378517868651352058841458</span><span class=p>,</span> <span class=mi>98160368638847675399572398674748989820793124316223139981985855809205341298949801328255193676763501201274664892968977440665912753652643866920809757293719818430444255015639083848225580011638253333896713028293846055458529120270575215996484868800961863545736109208008592247509627201121713291801184428552756145377</span><span class=p>,</span> <span class=mi>70279666367663945104159396963722599443271538912699448265711060345564659125916030957426375309362421105107348749935824650731170999396565032726246601380355258321403300241834231445800732010706990358094627163499472364138529856992133783183420053350913338600465093680827074012324157966344442294730635343631713549906</span><span class=p>,</span> <span class=mi>26334588403552340607768398401306649416040755108588686852906416781666048381323771223923748405041710715559064788598428283647378768153915565669694911025250778622002628864868653682135547573138160585696497105672184318572016275402944765554398056054008792299636594593784891344328744192547814256637485325927317001395</span><span class=p>,</span> <span class=mi>64763064376414100725233177531707850921895901489998530541566600837891901271286259632472966731652975882525518714861117936078937742875177256830813148392298636780335110743485184829629555885194866581373993856809276049684559851915531706344971288160366305524324492953122496357054696292196646886565479381358322089901</span><span class=p>,</span> <span class=mi>53117194717106647885894381448563589551431710951341823296134446602613706746061511004659195024758322208851050987552805791982437418655652792469412944720472972658226563166131320978600741791483309755403405454978613141796416330723219433461776878939616583985714124778821795628729912025022287270480633445555264913828</span><span class=p>,</span> <span class=mi>39008748355038168689186112775415171775080453538840696392929415443773790351994722271571121500900391631955057916363561421994355312684103960195488880752606720853798798281056868691805850650791447036298961423811854772591007911280152475310164832965003512721252819160190892144211679158575822375393777439609931384228</span><span class=p>,</span> <span class=mi>86894782492316823641474027353348280639827350140509498202323454802239795365765754893346836370629432362724021133533998222327533787772350966000212845689517598594730975441295282822776716711598532555271750263494233082883744371824351426984036331161881322183261364331109781030043400120020631277862928075639272480540</span><span class=p>,</span> <span class=mi>98160368638847675399572398674748989820793124316223139981985855809205341298949801328255193676763501201274664892968977440665912753652643866920809757293719818430444255015639083848225580011638253333896713028293846055458529120270575215996484868800961863545736109208008592247509627201121713291801184428552756145377</span><span class=p>,</span> <span class=mi>84177014604944804713431824977078430985039214840423548727302549935407939656001979736935056882466843836602458913229420653818014792087210619568737881610552000458150387886315505969718562202068244042324330912044030393635010283562361328009574502508818702705813189169328775333079963347257257925439630420220127175829</span><span class=p>,</span> <span class=mi>64763064376414100725233177531707850921895901489998530541566600837891901271286259632472966731652975882525518714861117936078937742875177256830813148392298636780335110743485184829629555885194866581373993856809276049684559851915531706344971288160366305524324492953122496357054696292196646886565479381358322089901</span><span class=p>,</span> <span class=mi>53117194717106647885894381448563589551431710951341823296134446602613706746061511004659195024758322208851050987552805791982437418655652792469412944720472972658226563166131320978600741791483309755403405454978613141796416330723219433461776878939616583985714124778821795628729912025022287270480633445555264913828</span><span class=p>,</span> <span class=mi>55246916646286914625187113796720048819441939566665506017385493092856767339656526237362346906721544511645358309134070927853338504353951702813761072243997031326763934289184435155017089001073820925041450839537239147841610796100383324289859233339039655637333071097315278349550850982664574507930331009748462710911</span><span class=p>,</span> <span class=mi>106648375177462244814956519863142484434517967715967260171155727468274165192829479031138664506248057814216598696573245004451813985881502107038970656193031218207987149410860333008967386597854794100347199877481501059868628561247838289796884990343108454123533819113308605079660529262282363403293782905105286943413</span><span class=p>,</span> <span class=mi>64763064376414100725233177531707850921895901489998530541566600837891901271286259632472966731652975882525518714861117936078937742875177256830813148392298636780335110743485184829629555885194866581373993856809276049684559851915531706344971288160366305524324492953122496357054696292196646886565479381358322089901</span><span class=p>,</span> <span class=mi>53117194717106647885894381448563589551431710951341823296134446602613706746061511004659195024758322208851050987552805791982437418655652792469412944720472972658226563166131320978600741791483309755403405454978613141796416330723219433461776878939616583985714124778821795628729912025022287270480633445555264913828</span><span class=p>,</span> <span class=mi>31650942089375642510054326764892516358156398346137044526825293211184610770488763216089112327665960486732029154795363125415308882529637371792323952011503181694383542249053937049705363331841430627186294230178074563022408165996381257431458584741639584809242782643138124672566959509661990281446947609872835868259</span><span class=p>,</span> <span class=mi>57445856580199047555821927276408547257287234119338383547680295248191332034583683110165244464867776524537766857873926746540178335971787038248326614035471638752532669724573592659987617219775753496418743022777874643326596350807062794404419710292631420242689457262146875057234137466703977429352051675954990924180</span><span class=p>,</span> <span class=mi>52733271064742986069580185401136225085723910924586198924963032082504789759300764373422629882605818076528578345298891993301672368391137050104915904160017718192142731169500900964695475818325453992891982593375220239226277506904476711254127320329801845264516893252806655032312577411519336691811621335647129023361</span><span class=p>,</span> <span class=mi>53117194717106647885894381448563589551431710951341823296134446602613706746061511004659195024758322208851050987552805791982437418655652792469412944720472972658226563166131320978600741791483309755403405454978613141796416330723219433461776878939616583985714124778821795628729912025022287270480633445555264913828</span><span class=p>,</span> <span class=mi>26334588403552340607768398401306649416040755108588686852906416781666048381323771223923748405041710715559064788598428283647378768153915565669694911025250778622002628864868653682135547573138160585696497105672184318572016275402944765554398056054008792299636594593784891344328744192547814256637485325927317001395</span><span class=p>,</span> <span class=mi>86894782492316823641474027353348280639827350140509498202323454802239795365765754893346836370629432362724021133533998222327533787772350966000212845689517598594730975441295282822776716711598532555271750263494233082883744371824351426984036331161881322183261364331109781030043400120020631277862928075639272480540</span><span class=p>,</span> <span class=mi>53117194717106647885894381448563589551431710951341823296134446602613706746061511004659195024758322208851050987552805791982437418655652792469412944720472972658226563166131320978600741791483309755403405454978613141796416330723219433461776878939616583985714124778821795628729912025022287270480633445555264913828</span><span class=p>,</span> <span class=mi>98420054751348658774654768769711772575456856329670343536374214734125293362008191863353279362661406706630812620085457858523242832046777520147019565432158787727926701046522801552223950521984840410467512317098698121156619169844565429672876258879490904439880561021274307016589721198271903007801901439744506436516</span><span class=p>,</span> <span class=mi>8103856376845753749810636625954342348018992185519844669722934214750220704461506083125434201240659143412545192044085752110862173338746105220687527651499789257412505481727824115069835196124083503200171598235085429192694286297720468885721800993830272620709634783849094028115111736986619372457889210633015446035</span><span class=p>,</span> <span class=mi>84177014604944804713431824977078430985039214840423548727302549935407939656001979736935056882466843836602458913229420653818014792087210619568737881610552000458150387886315505969718562202068244042324330912044030393635010283562361328009574502508818702705813189169328775333079963347257257925439630420220127175829</span><span class=p>,</span> <span class=mi>26334588403552340607768398401306649416040755108588686852906416781666048381323771223923748405041710715559064788598428283647378768153915565669694911025250778622002628864868653682135547573138160585696497105672184318572016275402944765554398056054008792299636594593784891344328744192547814256637485325927317001395</span><span class=p>,</span> <span class=mi>86894782492316823641474027353348280639827350140509498202323454802239795365765754893346836370629432362724021133533998222327533787772350966000212845689517598594730975441295282822776716711598532555271750263494233082883744371824351426984036331161881322183261364331109781030043400120020631277862928075639272480540</span><span class=p>,</span> <span class=mi>98160368638847675399572398674748989820793124316223139981985855809205341298949801328255193676763501201274664892968977440665912753652643866920809757293719818430444255015639083848225580011638253333896713028293846055458529120270575215996484868800961863545736109208008592247509627201121713291801184428552756145377</span><span class=p>,</span> <span class=mi>52733271064742986069580185401136225085723910924586198924963032082504789759300764373422629882605818076528578345298891993301672368391137050104915904160017718192142731169500900964695475818325453992891982593375220239226277506904476711254127320329801845264516893252806655032312577411519336691811621335647129023361</span><span class=p>,</span> <span class=mi>73198532513569656825655932815116028623768108369022850693529471046786059562748754190203684724306442952754102776745207511288787858904129031621886376980579480123167701603828307388858285877348902045940914696081392483634390312790021307265070190586697015612393856134764738032761300682449532714249075851386488278344</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>my_gcd</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=o>.</span><span class=n>monic</span><span class=p>()</span> <span class=k>if</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>my_gcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>%</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m1</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&#34;s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m2</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=s2>&#34;c&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>512</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span><span class=o>.&lt;</span><span class=n>X</span><span class=o>&gt;</span> <span class=o>=</span> <span class=n>Zmod</span><span class=p>(</span><span class=n>n</span><span class=p>)[]</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>k</span> 
</span></span><span class=line><span class=cl>    <span class=n>f1</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>m1</span><span class=o>+</span><span class=n>X</span><span class=p>)</span><span class=o>^</span><span class=n>e</span> <span class=o>-</span> <span class=n>cs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>f2</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>m2</span><span class=o>+</span><span class=n>X</span><span class=p>)</span><span class=o>^</span><span class=n>e</span> <span class=o>-</span> <span class=n>cs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=o>-</span> <span class=n>my_gcd</span><span class=p>(</span><span class=n>f1</span><span class=p>,</span> <span class=n>f2</span><span class=p>)</span><span class=o>.</span><span class=n>coefficients</span><span class=p>()[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;k = </span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>((</span><span class=n>a</span><span class=o>*</span><span class=n>x</span><span class=o>+</span><span class=n>b</span><span class=p>)</span><span class=o>^</span><span class=n>e</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span> <span class=o>==</span> <span class=n>c</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># k = 366 sctf{brut3_f0rc3_7h3_w4y_t0_v1ct0ry}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=inverse-reversal>Inverse Reversal</h3><p>なんか別解があるかもしれない</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span><span class=n>inverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>115212497901906646076814945650309895223065016560945864089583972246705800990408483001623222186324281257478104684257852308787917125013403838511481248490878740277179793165166692920877439191759389913333342083969182732100040787346793325220621228831728421953145471976655292176384523616588290831652574119800536966597</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=mi>19342653619736321095019406739262858513292763553015427066205052775548921803712884940275240366691800221581311317505876509706704872192509791241353606371262312134419486455811905110699389036576438861749023222249924933100895188124818488844030692986386829677836303137950484789561971041735662663305221446673307607903</span>
</span></span><span class=line><span class=cl><span class=n>cs</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>10614892818365802934451081378888295041081933298314928457901366555968758473121378170911908812818997986081798069596185564224503943996567858768096095178074783142157529299486123996800432099683337523921701427572226532224929782596836875496174442947880382545797686865815099891604486286261919787127731895584214253785</span><span class=p>,</span> <span class=mi>72453657083310089257132068668974440912111801910670468142317456734350746471656367901264395778244635699977087097440995706702553124375734909696651750134682685709474688342738091903309538593951219266496664218122721154957824947660952033076392157464628668943992581665800520466971397710440867328436725612844277185616</span><span class=p>,</span> <span class=mi>98647759533143513480808149613887823568238300609882691602096508004696657959802528537131254224850762306677259319833460144958287042247188426802367363927273056606211932763782568610947132004917354050553817497737126062407543531223388475777919791247670350517819379638325075367384138491381057683847737466150749906086</span><span class=p>,</span> <span class=mi>5024106669088093463562003718960109330705313562374543452438528313602617855905357532401880976240908091589698502023900906193469696286523508656527954451217307246424367688322103788009065126131508639251724653910735464299488376026339973561512095039160255996331127424626346940134555201647184801777652970005802921143</span><span class=p>,</span> <span class=mi>57173566276152839839326205894969370339758769921399891434875201283350731025118233760406235071539545354369673595264536860334831405072362487356080042621379546106920371432129691982972436507749869786965986222104013143255093818747178117303575600939508848006078594085804147598648950372495589242867378340844539661829</span><span class=p>,</span> <span class=mi>72453657083310089257132068668974440912111801910670468142317456734350746471656367901264395778244635699977087097440995706702553124375734909696651750134682685709474688342738091903309538593951219266496664218122721154957824947660952033076392157464628668943992581665800520466971397710440867328436725612844277185616</span><span class=p>,</span> <span class=mi>30435994844696312458494966250848321779446940788476109430292339003759154360078941628171673055563466722255430556678813632559392927613683797507011461879353648054072770458773867982674111453591882581233508653698601274594552675881288898660885862998206884728148995407501713146968533321243438589523371623699094795941</span><span class=p>,</span> <span class=mi>101327808423581541592927587047949532461793587521748592441894490558592733574958025837374249565965539028382209688316495047271591406329064827819425085902480209825849591040817009596108200881620618935625503689726361288586186992320497576451483131062751737536741217186325586722811410637968567618389787684331857560466</span><span class=p>,</span> <span class=mi>87327169844523983024186122383572724936154831354783181878608891256805223750743051844195949497070499407051410981035689713887898481337279219925556788783414737155282223548872037661604716321394914122415178667868475649231602861435439948258055912755300227699665009680374017179552306049067806593638989478265257595623</span><span class=p>,</span> <span class=mi>83389481040888030497790856848973402030638198599319104116648084674236455938345675099368791841144352956046785402693005865670852470990434078462372280366029119995664273357425145926363303962778643242574305196497209905020602604439770139514055798012244591463708875277734005171406049852868517184826790127424279602263</span><span class=p>,</span> <span class=mi>26792604381377646077098396402793260738684852310097622835968043750488106684330389237457168995202432614926580714465344748955074731719122502856866853487774583986285615961561621872145383441414834424713492508633213590761466745269943443807603367636717881288504235179294189373487936760761540576883070654916009409489</span><span class=p>,</span> <span class=mi>35426564731555513889237851465082545080255618916833078895301715072525216421320154889997120839511818209471077625066596255091975363510085882249655811276653233946009549269824606063686727755715259122186269630597735752989834148511877377230724853255333533300337152431524296263063305208567628038219756987849457785148</span><span class=p>,</span> <span class=mi>72453657083310089257132068668974440912111801910670468142317456734350746471656367901264395778244635699977087097440995706702553124375734909696651750134682685709474688342738091903309538593951219266496664218122721154957824947660952033076392157464628668943992581665800520466971397710440867328436725612844277185616</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>30281694323753863441458350867904624817874667313481502785042126500756321120109405758999655235727302061889490451635511689922900929396338872303053038123411867687502338609514654580525716898320102869066117558818006714170127735357538143274531326933123213412752430796055539684175708243042908698142872283111107911608</span><span class=p>,</span> <span class=mi>35426564731555513889237851465082545080255618916833078895301715072525216421320154889997120839511818209471077625066596255091975363510085882249655811276653233946009549269824606063686727755715259122186269630597735752989834148511877377230724853255333533300337152431524296263063305208567628038219756987849457785148</span><span class=p>,</span> <span class=mi>55947104004191368365525210908485429681715011104626243979740505073406415385317433313938927531181223866386726543803621434029056235995279269101857548719257175008980354239448996290266943546288142431829714013341868359231844108948117002182179094761193999997792925591224764364942764312381437578659564620658162873394</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>85267805011078363506697155175062140207445636998652678963847567597112933065517043730217680585462732863070856582374109392402549375548014962953949834827583055566900127699689740704152509523751459328749013852559215003223022025558104675431581960531031400080057668288019225200618673162281176331058730009345028638060</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>101327808423581541592927587047949532461793587521748592441894490558592733574958025837374249565965539028382209688316495047271591406329064827819425085902480209825849591040817009596108200881620618935625503689726361288586186992320497576451483131062751737536741217186325586722811410637968567618389787684331857560466</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>55947104004191368365525210908485429681715011104626243979740505073406415385317433313938927531181223866386726543803621434029056235995279269101857548719257175008980354239448996290266943546288142431829714013341868359231844108948117002182179094761193999997792925591224764364942764312381437578659564620658162873394</span><span class=p>,</span> <span class=mi>48701029335169050508642116151835089481818697324049380991235220805438674667171014369618826489746401294080141491827209900960986109207050654566836044829486033474924457434225003427052894914134076164371360065924409850345014725627321986139065590438897603233947896392172107313010455120719211550140742035249226008482</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>72453657083310089257132068668974440912111801910670468142317456734350746471656367901264395778244635699977087097440995706702553124375734909696651750134682685709474688342738091903309538593951219266496664218122721154957824947660952033076392157464628668943992581665800520466971397710440867328436725612844277185616</span><span class=p>,</span> <span class=mi>35426564731555513889237851465082545080255618916833078895301715072525216421320154889997120839511818209471077625066596255091975363510085882249655811276653233946009549269824606063686727755715259122186269630597735752989834148511877377230724853255333533300337152431524296263063305208567628038219756987849457785148</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>95986447367326045426093398035717128745163168231027353313760049410714829280428132832024046121355336674565326660817719248178163295994324691661441849140970460223065048107525352432555086007197658274507458708928265358450858922214849451622695839976809845404589461849583560990174570270949221589643971236255473759502</span><span class=p>,</span> <span class=mi>48701029335169050508642116151835089481818697324049380991235220805438674667171014369618826489746401294080141491827209900960986109207050654566836044829486033474924457434225003427052894914134076164371360065924409850345014725627321986139065590438897603233947896392172107313010455120719211550140742035249226008482</span><span class=p>,</span> <span class=mi>55947104004191368365525210908485429681715011104626243979740505073406415385317433313938927531181223866386726543803621434029056235995279269101857548719257175008980354239448996290266943546288142431829714013341868359231844108948117002182179094761193999997792925591224764364942764312381437578659564620658162873394</span><span class=p>,</span> <span class=mi>102196388132599661465127193498136214712734194555655476808934335897150648235342527038264806315430610409951157462783049809187879614657038847599689303851674413518624572369961782451485453027424159211981889371367117652871850755510134374933378219884631142150177303670825264449000800735646906719228306418991923032954</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>101327808423581541592927587047949532461793587521748592441894490558592733574958025837374249565965539028382209688316495047271591406329064827819425085902480209825849591040817009596108200881620618935625503689726361288586186992320497576451483131062751737536741217186325586722811410637968567618389787684331857560466</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>5723729500504613988911012649235488314230597739998519880019057473508281675665686082911553905048649088376231234736824807660779859279904139231528796753965476265375603355980972192840798014180095210645960735022184908387410405125923950581976641525552168832330666924058878897788723720324546796860220974929285264525</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>87307118345310119702653258381222073997804918741479869849232042749266878907749898467232887168663477815484043456727924324857395490287647603394842113311356233210988146555085321731058015777591227193439937161999647013197843369064629243657749023009638738937385179227360016071066981347721566597740037811800028211483</span><span class=p>,</span> <span class=mi>19267198945211754297861142477484287320095370091394051943504033284349930360528342837033482462198025535111342423655963398315577109419041936760730669884411765478038017214819407760529579393734167528794080178740275931809218061260127483809186886377334175072486121939122414822581819234903557620052078724578274336979</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>72453657083310089257132068668974440912111801910670468142317456734350746471656367901264395778244635699977087097440995706702553124375734909696651750134682685709474688342738091903309538593951219266496664218122721154957824947660952033076392157464628668943992581665800520466971397710440867328436725612844277185616</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>101327808423581541592927587047949532461793587521748592441894490558592733574958025837374249565965539028382209688316495047271591406329064827819425085902480209825849591040817009596108200881620618935625503689726361288586186992320497576451483131062751737536741217186325586722811410637968567618389787684331857560466</span><span class=p>,</span> <span class=mi>55947104004191368365525210908485429681715011104626243979740505073406415385317433313938927531181223866386726543803621434029056235995279269101857548719257175008980354239448996290266943546288142431829714013341868359231844108948117002182179094761193999997792925591224764364942764312381437578659564620658162873394</span><span class=p>,</span> <span class=mi>34127146941936481372477524347174117649543594283221953160342239294107648519617758930779009979264231794082412213309938596375010903970416283286233605009292396324305464727125961014269918486135625551623103604605601774775786507536802097511555024071288539917105378126303073132004204929338960101156320517452626686652</span><span class=p>,</span> <span class=mi>52036255893604477341934715473810269030247970205817055291498072878207547013204193378727013580540645618246526209850184390851220916461481967751863907859616924688860684737369522252726376036744053616828413005343792610099733100451851438439525606136549372385352089579210361004619804029816700946031427054199386628434</span><span class=p>,</span> <span class=mi>10242353083978425331223562567797514269135215185677532560179294927783959853514576981778894630349657921370334867951932593410475405995555736289847906042154384112685837678725023193827132344629725212164816493692848875410307544085203226440101540274011526700374931385518493417831316368488321727325515184568151426455</span><span class=p>,</span> <span class=mi>46694861756002366916735706731645345372121033836980649100683722948357911912209141799920512867115893415002115075227691875589099809025019151369694200136210026519207841609285202410859349378827669505134459181680564235975074207427460022602304708994084086149876123334646641467468267011532759183033751055001391252393</span><span class=p>,</span> <span class=mi>87307118345310119702653258381222073997804918741479869849232042749266878907749898467232887168663477815484043456727924324857395490287647603394842113311356233210988146555085321731058015777591227193439937161999647013197843369064629243657749023009638738937385179227360016071066981347721566597740037811800028211483</span><span class=p>,</span> <span class=mi>43047625107074961743170004020658620084375081659174244597272835102164875655042305084803789362225520075857994590638259054752253410693500437272595903397968434067504193320473056550732678581801885531679906689781871720252899783313666739622387198014024957715716687506601726301004202794916941972004298741372447690057</span><span class=p>,</span> <span class=mi>87327169844523983024186122383572724936154831354783181878608891256805223750743051844195949497070499407051410981035689713887898481337279219925556788783414737155282223548872037661604716321394914122415178667868475649231602861435439948258055912755300227699665009680374017179552306049067806593638989478265257595623</span><span class=p>,</span> <span class=mi>34127146941936481372477524347174117649543594283221953160342239294107648519617758930779009979264231794082412213309938596375010903970416283286233605009292396324305464727125961014269918486135625551623103604605601774775786507536802097511555024071288539917105378126303073132004204929338960101156320517452626686652</span><span class=p>,</span> <span class=mi>69401495296315236368718189446344847520286894008520044766291962539023820618489257611028622222220014116454719109759418409883461463688088367181672431220134841451073808647367929163997951756171813410992531555853898652264760449505145105799573640215730814597454224932899513190043479574222894026750074303259912745643</span><span class=p>,</span> <span class=mi>19267198945211754297861142477484287320095370091394051943504033284349930360528342837033482462198025535111342423655963398315577109419041936760730669884411765478038017214819407760529579393734167528794080178740275931809218061260127483809186886377334175072486121939122414822581819234903557620052078724578274336979</span><span class=p>,</span> <span class=mi>24346144695681590205349279067665806307892343388448165134580850348646482294775320169625483132724950488697263847722957438768547341498183051173837126838765595397122139533539637543298860767155484880312594916234756288467120142402936525777313927872039953924465047920575821880648588810646217010641449050348837280578</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mat_mul</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>I</span><span class=p>,</span> <span class=n>J</span><span class=p>,</span> <span class=n>K</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>J</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>I</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>I</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>J</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>K</span><span class=p>)</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>b</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>%=</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mat_pow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>n</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=n>mat_mul</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>mat_mul</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=p>[[</span><span class=n>c</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=n>mat</span> <span class=o>=</span> <span class=p>[[</span><span class=n>c</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=n>mat_mul</span><span class=p>(</span><span class=n>mat_pow</span><span class=p>(</span><span class=n>mat</span><span class=p>,</span> <span class=n>d</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span> <span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=n>inverse</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>n</span><span class=p>))</span><span class=o>%</span><span class=n>n</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>x</span> <span class=o>==</span> <span class=n>ret</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=p>)</span> <span class=c1># sctf{St4rlight_Wh1sp3rs_1n_th3_Un1v3rs3&#39;s_Myst3r10us_M3l0dy}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=dsa-starter>DSA starter</h3><p>DSAのアルゴリズムをそのまま適用します。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># DSA</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Random.random</span> <span class=kn>import</span> <span class=n>randint</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>shuffle</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=mi>178152782381825178803219174463700910343887635796771256691167008807374935805608810619510355568394750688608183393843518297273118359566453071394197733833035896858630558725699316955042421744365078468534495190922167403912399698372676556069049828057115488315878767055028995972138905736540492834987058578356095483777</span><span class=p>,</span> <span class=mi>886462388902383667466763577880397720831607417567</span><span class=p>,</span> <span class=mi>63028074410235712650856818704197230709567749692836951562649290014316138139312359167371415041184383722629991416556492666859022007320300058824552605629526632600490856764473931862464430933236982859019405547828622063621971180492882956812095615397762837988938242853452722411843661219861190400890315806421801546353</span><span class=p>,</span> <span class=mi>38647414566356138569980136086529833930398825658110621806133281938642505973525550931612864354218115649244247745143865068040333379732358277345437679898306683569802690274384584277131839415050015738332670477850796862979487857316281608801669816739648374889909541749203238997633769097943033727833275138527729141082</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=mi>853709161711035525874302893962481214917053133801</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=mi>257021930968164571494098920024334244863049558820</span>
</span></span><span class=line><span class=cl><span class=n>candidates</span> <span class=o>=</span> <span class=p>[</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 署名の検証</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>candidates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>u1</span> <span class=o>=</span> <span class=p>(</span><span class=n>bytes_to_long</span><span class=p>(</span><span class=n>sha256</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>())</span> <span class=o>*</span> <span class=n>w</span><span class=p>)</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>u2</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span> <span class=o>*</span> <span class=n>w</span><span class=p>)</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>=</span> <span class=p>((</span><span class=nb>pow</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>u1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>u2</span><span class=p>,</span> <span class=n>p</span><span class=p>))</span> <span class=o>%</span> <span class=n>p</span><span class=p>)</span> <span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>v</span> <span class=o>==</span> <span class=n>r</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Found! </span><span class=si>{</span><span class=n>msg</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=c1># sctf{this_is_passcode_14987914387428957283749837987938471847812313}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=dh-starter>DH Starter</h3><p>Diffie-Hellman鍵共有のアルゴリズムは離散対数問題が解くことが難しいことを利用しています。が、今回は$p$が小さいので、Baby-step Giant-step法で解くことができてしまいます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># DSA</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>getStrongPrime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>randint</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>urandom</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>3449512277</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=mi>1853660196</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=mi>1844600045</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=mh>0x20bd91cc19f353375134ed6ac8ab9cd8</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=mh>0xc4f8d8b06d616d10ec48c15c1f313c584ee4c11768ec69582cd5a254ba010400679cee579d674c84bb560c38eef5b53e2e668f11fa0044ab79f9c5bd97a94ab6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># X^K ≡ Y (mod M) となるような K を求める</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bsgs</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>Y</span><span class=p>,</span> <span class=n>M</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>D</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sq</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>M</span><span class=o>**</span><span class=mf>.5</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Baby-step</span>
</span></span><span class=line><span class=cl>    <span class=n>Z</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>sq</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Z</span> <span class=o>=</span> <span class=n>Z</span> <span class=o>*</span> <span class=n>X</span> <span class=o>%</span> <span class=n>M</span>
</span></span><span class=line><span class=cl>        <span class=n>D</span><span class=p>[</span><span class=n>Z</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>Y</span> <span class=ow>in</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>D</span><span class=p>[</span><span class=n>Y</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Giant-step</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>M</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=n>M</span><span class=p>)</span> <span class=c1># R = X^(-sq)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>sq</span><span class=o>+</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>Y</span> <span class=o>=</span> <span class=n>Y</span> <span class=o>*</span> <span class=n>R</span> <span class=o>%</span> <span class=n>M</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>Y</span> <span class=ow>in</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>D</span><span class=p>[</span><span class=n>Y</span><span class=p>]</span> <span class=o>+</span> <span class=n>i</span><span class=o>*</span><span class=n>sq</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>bsgs</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>sha256</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>s</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1># sctf{Ro0t_Expr3ssi0n_Unveiling_Discrete_Logarithms}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=dhmo-backdoor>DHMO Backdoor</h3><p>DHアルゴリズムですが、素数$q$が用意されて、</p><ul><li>$p = q^2$</li><li>$g = q+1$</li></ul><p>という不思議なパラメータ設定になっています。
この条件下で$A, B$を計算すると、</p><p>$$
A = (1+q)^a \equiv 1 + aq \pmod{q^2} \\
B = (1+q)^b \equiv 1 + bq \pmod{q^2}
$$</p><p>というように、離散対数問題のように見えてただの線形方程式になってしまっています。よって、簡単に解けてしまいます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># DSA</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>getStrongPrime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>randint</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>urandom</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>95415937817579451380560331137505725674156858513926822163980264696859536466150605410084190929378877860698117457381837054218767245648636289250124372497832405773309953882151215182666896790688601517274746987312158949180001859580605523093541735579880492742320916914652237329506667385776239702594761823614432307209</span>
</span></span><span class=line><span class=cl><span class=n>g</span> <span class=o>=</span> <span class=mi>9768108200546278315194231322082114002915357430681820414703248793717480653233394063038860570648067384600535879456361644343100108834155177088164778679532548</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=mi>92453853458870576229518823501929360581552725741189278049516561961478833097172834801288760072546654951598477738730124366332805108801506092437910200235296192165845124855345940151854202354847168551454392462737787664299300742218459667689807033294098287219340833990501929320726865292649944555957036455424727547115</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=mi>56612820070987073806615211708626056370390413126863293367701116303948485194819573186994266503189322508232997547860696305447417646426321081076895093762235273029112042023440682941122763197970972104018354007661120535881288476220273010083950515697901659556323027333128910934151081165951565331390808856583772052696</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=mh>0x242277a2562e41e7a2c84f07802a2113</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=mh>0x672233ffe1d4d793373950d4c1c177cc5caeb5b7a468e51cf86b29d4feb5bfde7847a038d3bab1050021301a0139f9ac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># (1+q)^a = 1 + aq mod q^2</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>iroot</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>//</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>sha256</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>s</span><span class=p>))</span><span class=o>.</span><span class=n>digest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sctf{DHMO_Weakness_Revealed_Compromise_Eminent}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ecc-starter-1>ECC Starter 1</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=c1># y^2 = x^3 + ax + b mod p</span>
</span></span><span class=line><span class=cl><span class=n>Gx</span> <span class=o>=</span> <span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>Gy</span> <span class=o>=</span> <span class=mi>9</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>double</span><span class=p>(</span><span class=n>p1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>x0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>y0</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># 無限遠O</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>+</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>x0</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=o>*</span><span class=n>y0</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x4</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>x0</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y4</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x4</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x4</span><span class=p>,</span> <span class=n>y4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p2</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span><span class=o>%</span><span class=n>p</span> <span class=o>==</span> <span class=p>(</span><span class=o>-</span><span class=n>y2</span><span class=p>)</span><span class=o>%</span><span class=n>p</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span> <span class=o>==</span> <span class=n>y2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>double</span><span class=p>(</span><span class=n>p1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y2</span> <span class=o>-</span> <span class=n>y1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y1</span> <span class=o>*</span> <span class=n>x2</span> <span class=o>-</span> <span class=n>y2</span> <span class=o>*</span> <span class=n>x1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x3</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=n>x1</span> <span class=o>-</span> <span class=n>x2</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y3</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x3</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x3</span><span class=p>,</span> <span class=n>y3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=mi>12</span><span class=p>,</span><span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>R</span> <span class=o>=</span> <span class=n>add</span><span class=p>(</span><span class=n>P</span><span class=p>,</span><span class=n>Q</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>R</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>17</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=n>GF</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E</span> <span class=o>=</span> <span class=n>EllipticCurve</span><span class=p>(</span><span class=n>K</span><span class=p>,[</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>G</span> <span class=o>=</span> <span class=n>E</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=n>E</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>G</span><span class=o>+</span><span class=n>P</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{16}</code></p><h3 id=ecc-starter-2>ECC Starter 2</h3><p>$x$軸に対称な点を加算すると無限遠になります。
<code>sctf{4}</code></p><h3 id=ecc-starter-3>ECC Starter 3</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>double</span><span class=p>(</span><span class=n>p1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>x0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>y0</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># 無限遠O</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>+</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>x0</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=o>*</span><span class=n>y0</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x4</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>x0</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y4</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x4</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x4</span><span class=p>,</span> <span class=n>y4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p2</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span><span class=o>%</span><span class=n>p</span> <span class=o>==</span> <span class=p>(</span><span class=o>-</span><span class=n>y2</span><span class=p>)</span><span class=o>%</span><span class=n>p</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span> <span class=o>==</span> <span class=n>y2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>double</span><span class=p>(</span><span class=n>p1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y2</span> <span class=o>-</span> <span class=n>y1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y1</span> <span class=o>*</span> <span class=n>x2</span> <span class=o>-</span> <span class=n>y2</span> <span class=o>*</span> <span class=n>x1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x3</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=n>x1</span> <span class=o>-</span> <span class=n>x2</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y3</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x3</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x3</span><span class=p>,</span> <span class=n>y3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>double</span><span class=p>(</span><span class=n>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=o>//</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>add</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>double</span><span class=p>(</span><span class=n>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=o>//</span><span class=mi>2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>58831</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=c1># y^2 = x^3 + ax + b mod p</span>
</span></span><span class=line><span class=cl><span class=n>Gx</span> <span class=o>=</span> <span class=mi>28603</span>
</span></span><span class=line><span class=cl><span class=n>Gy</span> <span class=o>=</span> <span class=mi>46279</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=n>Gx</span><span class=p>,</span> <span class=n>Gy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Q</span>  <span class=o>=</span> <span class=n>mul</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>Q</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{15400}</code></p><h3 id=ecc-starter-4>ECC Starter 4</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>inverse</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>double</span><span class=p>(</span><span class=n>p1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>x0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y0</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>y0</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># 無限遠O</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>+</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>3</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>*</span> <span class=n>x0</span> <span class=o>-</span> <span class=n>a</span><span class=o>*</span><span class=n>x0</span> <span class=o>+</span> <span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=o>*</span><span class=n>y0</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=n>y0</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x4</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>x0</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y4</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x4</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x4</span><span class=p>,</span> <span class=n>y4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p1</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p2</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>p2</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y1</span> <span class=o>=</span> <span class=n>p1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>x2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>y2</span> <span class=o>=</span> <span class=n>p2</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span><span class=o>%</span><span class=n>p</span> <span class=o>==</span> <span class=p>(</span><span class=o>-</span><span class=n>y2</span><span class=p>)</span><span class=o>%</span><span class=n>p</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x1</span> <span class=o>==</span> <span class=n>x2</span> <span class=ow>and</span> <span class=n>y1</span> <span class=o>==</span> <span class=n>y2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>double</span><span class=p>(</span><span class=n>p1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>phi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y2</span> <span class=o>-</span> <span class=n>y1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>psi</span> <span class=o>=</span> <span class=p>(</span><span class=n>y1</span> <span class=o>*</span> <span class=n>x2</span> <span class=o>-</span> <span class=n>y2</span> <span class=o>*</span> <span class=n>x1</span><span class=p>)</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>x2</span> <span class=o>-</span> <span class=n>x1</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x3</span> <span class=o>=</span> <span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span> <span class=o>-</span> <span class=n>x1</span> <span class=o>-</span> <span class=n>x2</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=n>y3</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>x3</span> <span class=o>-</span> <span class=n>psi</span><span class=p>)</span> <span class=o>%</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x3</span><span class=p>,</span> <span class=n>y3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>p1</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>double</span><span class=p>(</span><span class=n>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=o>//</span><span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>add</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>double</span><span class=p>(</span><span class=n>mul</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>n</span><span class=o>//</span><span class=mi>2</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>3173581703</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=c1># y^2 = x^3 + ax + b mod p</span>
</span></span><span class=line><span class=cl><span class=n>Gx</span> <span class=o>=</span> <span class=mi>2922555662</span>
</span></span><span class=line><span class=cl><span class=n>Gy</span> <span class=o>=</span> <span class=mi>1379601526</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=n>Gx</span><span class=p>,</span> <span class=n>Gy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Q</span>  <span class=o>=</span> <span class=n>mul</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>Q</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>13</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>3173581703</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>K</span> <span class=o>=</span> <span class=n>GF</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>E</span> <span class=o>=</span> <span class=n>EllipticCurve</span><span class=p>(</span><span class=n>K</span><span class=p>,[</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>G</span> <span class=o>=</span> <span class=n>E</span><span class=p>(</span><span class=mi>2922555662</span><span class=p>,</span> <span class=mi>1379601526</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>G</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>((</span><span class=n>p</span><span class=p>)</span><span class=o>*</span><span class=n>G</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sctf{1012290686}</code></p><h3 id=ecc-starter-5>ECC Starter 5</h3><p><code>sctf{41712}</code></p><h3 id=ecc-vs-rsa>ECC vs. RSA</h3><p>楕円曲線上で、$e$倍した点を復元する問題です。$e$の逆元(楕円曲線の位数上で)を計算すればよいです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>getrandbits</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Cipher</span> <span class=kn>import</span> <span class=n>AES</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.Padding</span> <span class=kn>import</span> <span class=n>pad</span><span class=p>,</span> <span class=n>unpad</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span><span class=p>,</span> <span class=n>inverse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># secp256k1</span>
</span></span><span class=line><span class=cl><span class=n>bitsize</span> <span class=o>=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mh>0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>Gx</span> <span class=o>=</span> <span class=mh>0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span>
</span></span><span class=line><span class=cl><span class=n>Gy</span> <span class=o>=</span> <span class=mh>0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span>
</span></span><span class=line><span class=cl><span class=c1># exponent</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>E</span> <span class=o>=</span> <span class=n>EllipticCurve</span><span class=p>(</span><span class=n>GF</span><span class=p>(</span><span class=n>p</span><span class=p>),[</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=n>E</span><span class=p>(</span><span class=mi>93433963105152978020305311287114858750860633144092310644734267100070909728359</span><span class=p>,</span><span class=mi>49607652788439856681244209356178787315854579032619206302851865258501732308348</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mh>0x5ccc961542dab655f1fd94073b8d1becd031b371a2c849465a0b91dce3549d352daa3859e533ce27c343eed24a9f1808</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=mh>0xacc9a0d6dba3ebd3d8eb3655baaaae8a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>G</span> <span class=o>=</span> <span class=n>E</span><span class=p>(</span><span class=n>Gx</span><span class=p>,</span><span class=n>Gy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>Q</span><span class=o>.</span><span class=n>order</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>inverse</span><span class=p>(</span><span class=n>e2</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=n>d</span><span class=p>)</span><span class=o>*</span><span class=n>Q</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>P</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>AES</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>AES</span><span class=o>.</span><span class=n>MODE_CBC</span><span class=p>,</span> <span class=n>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>unpad</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=mi>16</span><span class=p>))</span> <span class=c1># sctf{Crypt0_Unveiled_Thr0ugh_ECC_RSA_Enigmas}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=knapsack-starter>Knapsack Starter</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=mi>19476848988204872060832823259129600051004287455211043516206652751259893783183944942428856467</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=mi>29311266273294587273200436915502354865358876784826842913113098289713485249949916371307504229</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>945990657049790727811563555213826037534670582134726526157349843403732326518548975197241258807</span>
</span></span><span class=line><span class=cl><span class=n>w</span> <span class=o>=</span> <span class=p>[</span><span class=mi>263228976889951266540541834687364181713</span><span class=p>,</span> <span class=mi>457935464639243892337831056783295578478</span><span class=p>,</span> <span class=mi>1058195876074085625891598742796685364429</span><span class=p>,</span> <span class=mi>1934211975170539017039476473246851471980</span><span class=p>,</span> <span class=mi>3813329232257528690875093473358573391068</span><span class=p>,</span> <span class=mi>7548351188526979796201239878428904609165</span><span class=p>,</span> <span class=mi>15342376214376299641734234847361388410502</span><span class=p>,</span> <span class=mi>30676111579055058805152748403012090457953</span><span class=p>,</span> <span class=mi>61314165415482354434033552561206591940507</span><span class=p>,</span> <span class=mi>122457509135354125562625114523776211913998</span><span class=p>,</span> <span class=mi>245045468370028825796324167156568593108193</span><span class=p>,</span> <span class=mi>490132911968585330062812415035249827516095</span><span class=p>,</span> <span class=mi>980336727631959359084042995890560952266031</span><span class=p>,</span> <span class=mi>1960712218890410427185218236979660909762713</span><span class=p>,</span> <span class=mi>3921165295359268585867075266058558190047491</span><span class=p>,</span> <span class=mi>7842448389418084606567626834395565528136167</span><span class=p>,</span> <span class=mi>15684854680112704228353230728336753483365450</span><span class=p>,</span> <span class=mi>31369856681810663918836565124030252512150917</span><span class=p>,</span> <span class=mi>62739514158667052998477170704377763994464875</span><span class=p>,</span> <span class=mi>125479138474588541117450796477672911548395031</span><span class=p>,</span> <span class=mi>250958183125832955449049108788435947510860683</span><span class=p>,</span> <span class=mi>501916497265011968966166509486889068874362376</span><span class=p>,</span> <span class=mi>1003833059492784419306001709963036828597523022</span><span class=p>,</span> <span class=mi>2007665977862164000887774833362203778917130761</span><span class=p>,</span> <span class=mi>4015331819318235561394427804904380224700572183</span><span class=p>,</span> <span class=mi>8030663847599794966775791679517475340506474867</span><span class=p>,</span> <span class=mi>16061327666741485196225754142518721068080943118</span><span class=p>,</span> <span class=mi>32122655345323353998576534454136019803643540679</span><span class=p>,</span> <span class=mi>64245310729616839356083520012998574603423950304</span><span class=p>,</span> <span class=mi>128490621341110194559129167379408144239346618394</span><span class=p>,</span> <span class=mi>256981242546615628019276807071248658031631670062</span><span class=p>,</span> <span class=mi>513962485288126713902190842333844183528809648761</span><span class=p>,</span> <span class=mi>1027924970600288450786489616484085599828091152701</span><span class=p>,</span> <span class=mi>2055849940990482356003425008869926100483221671690</span><span class=p>,</span> <span class=mi>4111699882034627857142016435195095613774416853442</span><span class=p>,</span> <span class=mi>8223399764305165028674983621512397264248203767081</span><span class=p>,</span> <span class=mi>16446799528556974948616834997022842102628346949905</span><span class=p>,</span> <span class=mi>32893599057155661341614967294809786188099159169000</span><span class=p>,</span> <span class=mi>65787198114289863299284895203500669221171935691836</span><span class=p>,</span> <span class=mi>131574396228310085788505514630103708420408554186039</span><span class=p>,</span> <span class=mi>263148792456705125867287379096890451580988570193459</span><span class=p>,</span> <span class=mi>526297584913529438181012879437140704409720583631137</span><span class=p>,</span> <span class=mi>1052595169826954745965463773116138739756314031103225</span><span class=p>,</span> <span class=mi>2105190339654059980131128392303874984820051581883518</span><span class=p>,</span> <span class=mi>4210380679308075385776419970405407011648148027267268</span><span class=p>,</span> <span class=mi>8420761358616068204682608730984585935797023148735240</span><span class=p>,</span> <span class=mi>16841522717232249663297795069152658737760298312512891</span><span class=p>,</span> <span class=mi>33683045434464430867773797571752143270644886204883278</span><span class=p>,</span> <span class=mi>67366090868928845127882400245536153537986749318215467</span><span class=p>,</span> <span class=mi>134732181737857628263363749789729833943267541695128439</span><span class=p>,</span> <span class=mi>269464363475715229776799440963157258797709780239020914</span><span class=p>,</span> <span class=mi>538928726951430501414854528372286612741407042677372934</span><span class=p>,</span> <span class=mi>1077857453902860973085094919440328725332384482706712426</span><span class=p>,</span> <span class=mi>2155714907805722202837631837419704718414663552265559180</span><span class=p>,</span> <span class=mi>4311429815611444242553606338400042927549486188375483412</span><span class=p>,</span> <span class=mi>8622859631222888393731412712717380322153162722607002277</span><span class=p>,</span> <span class=mi>17245719262445776934016465912139643732064795350553784834</span><span class=p>,</span> <span class=mi>34491438524891553747147568874352654535400550049840450634</span><span class=p>,</span> <span class=mi>68982877049783107438718799754373184986004472676167594261</span><span class=p>,</span> <span class=mi>137965754099566215102192084895283887966788005118662563572</span><span class=p>,</span> <span class=mi>275931508199132430030634007293021764123584504939475470385</span><span class=p>,</span> <span class=mi>551863016398264859986523382523585129022471394554055009435</span><span class=p>,</span> <span class=mi>1103726032796529720155003462265105606483256466111108698616</span><span class=p>,</span> <span class=mi>2207452065593059440240384970300352371199272846808008235379</span><span class=p>,</span> <span class=mi>4414904131186118880368717968671301367907045659783220840939</span><span class=p>,</span> <span class=mi>8829808262372237760948511909701827407796814078799892455848</span><span class=p>,</span> <span class=mi>17659616524744475521701487905508934342721167847585411763221</span><span class=p>,</span> <span class=mi>35319233049488951043417845329985524424774757313815096694704</span><span class=p>,</span> <span class=mi>70638466098977902086887899164405215395786894649535300442723</span><span class=p>,</span> <span class=mi>141276932197955804173745880247287180957442722334964370966546</span><span class=p>,</span> <span class=mi>282553864395911608347748022365954348935775529435297210695625</span><span class=p>,</span> <span class=mi>565107728791823216695400500048797452026936615561498504495800</span><span class=p>,</span> <span class=mi>1130215457583646433390684998047707208069791052942278824204418</span><span class=p>,</span> <span class=mi>2260430915167292866781340631462439052033775806549042273627757</span><span class=p>,</span> <span class=mi>4520861830334585733562622652226068575770631209817472344431374</span><span class=p>,</span> <span class=mi>9041723660669171467125263454374722081820235557791494551987159</span><span class=p>,</span> <span class=mi>18083447321338342934250524265736708001496740499019055190094538</span><span class=p>,</span> <span class=mi>36166894642676685868501113338137592286332612302544482485057756</span><span class=p>,</span> <span class=mi>72333789285353371737002141672613582208906219392570439901703721</span><span class=p>,</span> <span class=mi>144667578570706743474004416859793180811316017009618604250081956</span><span class=p>,</span> <span class=mi>289335157141413486948009002951513754094921145079351292435147195</span><span class=p>,</span> <span class=mi>578670314282826973896017865424292766255735419976456877004028357</span><span class=p>,</span> <span class=mi>1157340628565653947792035726945634328313560050099335903802848245</span><span class=p>,</span> <span class=mi>2314681257131307895584071484916560363546573736102282928362726573</span><span class=p>,</span> <span class=mi>4629362514262615791168142936189402163593833141975026198871598830</span><span class=p>,</span> <span class=mi>9258725028525231582336285931712985131658354715212582574367146995</span><span class=p>,</span> <span class=mi>18517450057050463164672571753794287902392074875599395173445001321</span><span class=p>,</span> <span class=mi>37034900114100926329345143433025043698658494079021716869810363729</span><span class=p>,</span> <span class=mi>74069800228201852658690286945201185424116608368809782136879911153</span><span class=p>,</span> <span class=mi>148139600456403705317380573848376468768454936157017896526821436751</span><span class=p>,</span> <span class=mi>296279200912807410634761147836417492562880077408464415839925812836</span><span class=p>,</span> <span class=mi>592558401825614821269522295541413003283623417844614775602991844926</span><span class=p>,</span> <span class=mi>1185116803651229642539044591270817571719591114346031119224088519762</span><span class=p>,</span> <span class=mi>2370233607302459285078089182311797790423709027951884197767219627489</span><span class=p>,</span> <span class=mi>4740467214604918570156178364606021453368837362296775448471763559944</span><span class=p>,</span> <span class=mi>9480934429209837140312356729250069790145748311960267934480838087905</span><span class=p>,</span> <span class=mi>18961868858419674280624713458751382088628232003250304088543309769230</span><span class=p>,</span> <span class=mi>37923737716839348561249426917310834526882249877135880939563199524561</span><span class=p>,</span> <span class=mi>75847475433678697122498853834661002608365834191029460986523516653115</span><span class=p>,</span> <span class=mi>151694950867357394244997707669233984078243395832393601212193574769823</span><span class=p>,</span> <span class=mi>303389901734714788489995415338484802549497462764751593085610926721251</span><span class=p>,</span> <span class=mi>606779803469429576979990830677134428924180420604088449473776489960306</span><span class=p>,</span> <span class=mi>1213559606938859153959981661354245194413895941475040359205842686583473</span><span class=p>,</span> <span class=mi>2427119213877718307919963322708252614754809336878944200561730368191557</span><span class=p>,</span> <span class=mi>4854238427755436615839926645416710779751561776235946421137139708078928</span><span class=p>,</span> <span class=mi>9708476855510873231679853290833317577704121721159966375281875830564338</span><span class=p>,</span> <span class=mi>19416953711021746463359706581666732514173999893774109133822452371497323</span><span class=p>,</span> <span class=mi>38833907422043492926719413163333385657156715009012938122750440578262832</span><span class=p>,</span> <span class=mi>77667814844086985853438826326666897878038082310410763610504701470130183</span><span class=p>,</span> <span class=mi>155335629688173971706877652653333586682032746273505115591234037181868344</span><span class=p>,</span> <span class=mi>310671259376347943413755305306667131736767942225328981428811870395643998</span><span class=p>,</span> <span class=mi>621342518752695886827510610613334390180071117312961860832391406841819242</span><span class=p>,</span> <span class=mi>1242685037505391773655021221226668763320733426469906257502944537706725839</span><span class=p>,</span> <span class=mi>2485370075010783547310042442453337627736279726847249205695542477157255942</span><span class=p>,</span> <span class=mi>4970740150021567094620084884906675211827314506471042035293373265626939830</span><span class=p>,</span> <span class=mi>9941480300043134189240169769813350276670008651025396844479521796298847105</span><span class=p>,</span> <span class=mi>19882960600086268378480339539626700605915482613788268719820910533965573007</span><span class=p>,</span> <span class=mi>39765921200172536756960679079253401436720214961803864078851996311157935833</span><span class=p>,</span> <span class=mi>79531842400345073513921358158506802706672865389846451345114874503205005213</span><span class=p>,</span> <span class=mi>159063684800690147027842716317013605468371993692078184096538877564792444780</span><span class=p>,</span> <span class=mi>318127369601380294055685432634027210881752581399639207186287992365392777467</span><span class=p>,</span> <span class=mi>636254739202760588111370865268054421884250687817733779499977175887424514055</span><span class=p>,</span> <span class=mi>1272509478405521176222741730536108843689152570208250597214250682306871063453</span><span class=p>,</span> <span class=mi>2545018956811042352445483461072217687200958170585479765867661071453005313204</span><span class=p>,</span> <span class=mi>5090037913622084704890966922144435374727224095711352896489635140639284558709</span><span class=p>,</span> <span class=mi>10180075827244169409781933844288870749150803604132946792902861730960130519101</span><span class=p>,</span> <span class=mi>20360151654488338819563867688577741498440231818050984814414131779001893954002</span><span class=p>,</span> <span class=mi>40720303308976677639127735377155482996907736287635668656167583298448205710726</span><span class=p>,</span> <span class=mi>81440606617953355278255470754310965993749845305293880609616965926254291966065</span><span class=p>,</span> <span class=mi>162881213235906710556510941508621931987383518233854591584928195206484523084469</span><span class=p>,</span> <span class=mi>325762426471813421113021883017243863975031551177758729440470449095297505125034</span><span class=p>,</span> <span class=mi>651524852943626842226043766034487727950001553814845214384370479452678770364486</span><span class=p>,</span> <span class=mi>1303049705887253684452087532068975455899963985904839518584012121113144472278629</span><span class=p>,</span> <span class=mi>2606099411774507368904175064137950911800064973447132296429922340194207206283403</span><span class=p>,</span> <span class=mi>5212198823549014737808350128275901823600031933516369803366230858975355751742222</span><span class=p>,</span> <span class=mi>10424397647098029475616700256551803647199952513646467290746525005642958338658131</span><span class=p>,</span> <span class=mi>20848795294196058951233400513103607294399865165820761853103287568442192655904557</span><span class=p>,</span> <span class=mi>41697590588392117902466801026207214588799775496407528083559167958620980948129123</span><span class=p>,</span> <span class=mi>83395181176784235804933602052414429177599478133657109937098904135479294173925163</span><span class=p>,</span> <span class=mi>166790362353568471609867204104828858355199142821865559664818176369748440091865937</span><span class=p>,</span> <span class=mi>333580724707136943219734408209657716710398084055335450415180886098089029002838155</span><span class=p>,</span> <span class=mi>667161449414273886439468816419315433420796288526206915881212684246336427399630981</span><span class=p>,</span> <span class=mi>1334322898828547772878937632838630866841592652133597315692233339916367877136281186</span><span class=p>,</span> <span class=mi>2668645797657095545757875265677261733683185227803667762780671479934012015987584583</span><span class=p>,</span> <span class=mi>5337291595314191091515750531354523467366370314564538407749812829898633825373399680</span><span class=p>,</span> <span class=mi>10674583190628382183031501062709046934732740774556387387862300273499571252048865079</span><span class=p>,</span> <span class=mi>21349166381256764366063002125418093869465481720805671426454128431134329516135095761</span><span class=p>,</span> <span class=mi>42698332762513528732126004250836187738930963282482100862796467954829168376044456878</span><span class=p>,</span> <span class=mi>85396665525027057464252008501672375477861926499746255378365668800226613007580617247</span><span class=p>,</span> <span class=mi>170793331050054114928504017003344750955723853028399583392630736846908044182196193007</span><span class=p>,</span> <span class=mi>341586662100108229857008034006689501911447706242980595606170845145627101786522415403</span><span class=p>,</span> <span class=mi>683173324200216459714016068013379003822895412498690191005975508101333950029720159355</span><span class=p>,</span> <span class=mi>1366346648400432919428032136026758007645790825004255814047917130079813940756486579954</span><span class=p>,</span> <span class=mi>2732693296800865838856064272053516015291581649768642168926936527369393080354781167740</span><span class=p>,</span> <span class=mi>5465386593601731677712128544107032030583163299770499928222287223443786634370668059852</span><span class=p>,</span> <span class=mi>10930773187203463355424257088214064061166326599293081832651132958631628113141503796974</span><span class=p>,</span> <span class=mi>21861546374406926710848514176428128122332653198798219733689320505230168037031634772693</span><span class=p>,</span> <span class=mi>43723092748813853421697028352856256244665306397312102686768877285823463474179918401903</span><span class=p>,</span> <span class=mi>87446185497627706843394056705712512489330612794900982032101851797136904153336456238020</span><span class=p>,</span> <span class=mi>174892370995255413686788113411425024978661225589557302145435604480844789031725418075992</span><span class=p>,</span> <span class=mi>349784741990510827373576226822850049957322451179335479358445853411807130258467327702021</span><span class=p>,</span> <span class=mi>699569483981021654747152453645700099914644902358741940569264175414201762057057799022129</span><span class=p>,</span> <span class=mi>1399138967962043309494304907291400199829289804717165770650446407070302606046582025974620</span><span class=p>,</span> <span class=mi>2798277935924086618988609814582800399658579609434558489360516727584419391721419833736445</span><span class=p>,</span> <span class=mi>5596555871848173237977219629165600799317159218868899160948298515143384316463999067586636</span><span class=p>,</span> <span class=mi>11193111743696346475954439258331201598634318437737879857707609916687973601545341951410159</span><span class=p>,</span> <span class=mi>22386223487392692951908878516662403197268636875475806289175077655992859464525002451610176</span><span class=p>,</span> <span class=mi>44772446974785385903817757033324806394537273750951700014946615606735494776383693258655688</span><span class=p>,</span> <span class=mi>89544893949570771807635514066649612789074547501903184095022764183600184336070525246028640</span><span class=p>,</span> <span class=mi>179089787899141543615271028133299225578149095003806543606123912894383587333125968090708987</span><span class=p>,</span> <span class=mi>358179575798283087230542056266598451156298190007613060740055284132334732369346512327144844</span><span class=p>,</span> <span class=mi>716359151596566174461084112533196902312596380015226109582319932656020963488351038028739646</span><span class=p>,</span> <span class=mi>1432718303193132348922168225066393804625192760030452163868958382266333790500844020941445604</span><span class=p>,</span> <span class=mi>2865436606386264697844336450132787609250385520060904416604457827324560131134874955795659071</span><span class=p>,</span> <span class=mi>5730873212772529395688672900265575218500771040121808724814913279500673400050155498850067943</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span><span class=o>%</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>c</span> <span class=o>&gt;=</span> <span class=n>w</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>+=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>-=</span> <span class=n>w</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{NP-Hard_Knapsack}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=whats-in-the-bag>What&rsquo;s in the bag?</h3><p>$w,q$の値がわかりませんが、配布ファイルをよく見ると乱数は使っておらず、毎回同じ値が求まるようにできているので、これを利用して$w,q$を求めます。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=mi>460512672224238860814315137993310742357595503044391945632042049419054327951919468685681985</span><span class=p>,</span> <span class=mi>1381538016672716582442945413979932227072786509133175836896126148257162983855758406057045955</span><span class=p>,</span> <span class=mi>4144614050018149747328836241939796681218359527399527510688378444771488951567275218171137865</span><span class=p>,</span> <span class=mi>5686547812913902340122430027557447584953827435183531575031782650803505850248688861484284418</span><span class=p>,</span> <span class=mi>3565054764460613216639132686148457837458980011520492811028642585388595541839792998394594900</span><span class=p>,</span> <span class=mi>3947869956241292748053319360183431053675688887546427476052575072654825621066242202154655523</span><span class=p>,</span> <span class=mi>5096315531583331342295879382288350702325815515624231471124372534453515858745589813434837392</span><span class=p>,</span> <span class=mi>1794357920468900223159480750341167189574944252842592499306412236338625567330495854246253822</span><span class=p>,</span> <span class=mi>5383073761406700669478442251023501568724832758527777497919236709015876701991487562738761466</span><span class=p>,</span> <span class=mi>2654632609939008204707169356546619788771995981553230579691004760025708097068189102158026044</span><span class=p>,</span> <span class=mi>1216603492676477712257429371377916907614736797644640782039661596566163286751430513444948955</span><span class=p>,</span> <span class=mi>3649810478029433136772288114133750722844210392933922346118984789698489860254291540334846865</span><span class=p>,</span> <span class=mi>4202137096947752508452785644139309709831380031786716081323601685584508576309737827975411418</span><span class=p>,</span> <span class=mi>5859116953702710623494278234155986670792888948345097286937452373242564724476076690897105077</span><span class=p>,</span> <span class=mi>4082762186827038066754677305944075094976164551005189946745651752705772164521956486633056877</span><span class=p>,</span> <span class=mi>5500992223340567298399953219570282826227242506000518883203602574606355489112732666870041454</span><span class=p>,</span> <span class=mi>3008387995740608091471702262186963561279225223971454735544102356797144458431924414551866008</span><span class=p>,</span> <span class=mi>2277869650081277372551028088298948225136424524899313249598954386880472370842636450626468847</span><span class=p>,</span> <span class=mi>86314613103285215789005566634902216708022427682888791763510477130456108074772558850277364</span><span class=p>,</span> <span class=mi>258943839309855647367016699904706650124067283048666375290531431391368324224317676550832092</span><span class=p>,</span> <span class=mi>776831517929566942101050099714119950372201849145999125871594294174104972672953029652496276</span><span class=p>,</span> <span class=mi>2330494553788700826303150299142359851116605547437997377614782882522314918018859088957488828</span><span class=p>,</span> <span class=mi>244189324225555577045372199165137094648565495298941175810995964055983749603440473843337307</span><span class=p>,</span> <span class=mi>732567972676666731136116597495411283945696485896823527432987892167951248810321421530011921</span><span class=p>,</span> <span class=mi>2197703918030000193408349792486233851837089457690470582298963676503853746430964264590035763</span><span class=p>,</span> <span class=mi>6593111754090000580225049377458701555511268373071411746896891029511561239292892793770107289</span><span class=p>,</span> <span class=mi>6284746587988907936946990735852219749131302825184133326623967721512761708972404795252063513</span><span class=p>,</span> <span class=mi>5359651089685630007112814811032774329991406181522298065805197797516363118010940799697932185</span><span class=p>,</span> <span class=mi>2584364594775796217610287036574438072571716250536792283348888025527167345126548813035538201</span><span class=p>,</span> <span class=mi>1005799447186841750966782411461371759013897604595325893013311393070541030926509646077485426</span><span class=p>,</span> <span class=mi>3017398341560525252900347234384115277041692813785977679039934179211623092779528938232456278</span><span class=p>,</span> <span class=mi>2304900687541028856836963004890403372423827294342882080086449854123908273885450021668239657</span><span class=p>,</span> <span class=mi>167407725482539668646810316409267658570230736013595283225996878860763817203213271975589794</span><span class=p>,</span> <span class=mi>502223176447619005940430949227802975710692208040785849677990636582291451609639815926769382</span><span class=p>,</span> <span class=mi>1506669529342857017821292847683408927132076624122357549033971909746874354828919447780308146</span><span class=p>,</span> <span class=mi>4520008588028571053463878543050226781396229872367072647101915729240623064486758343340924438</span><span class=p>,</span> <span class=mi>65437089804619356663478232626795426786187323071116027239041820699947184554001443964514960</span><span class=p>,</span> <span class=mi>196311269413858069990434697880386280358561969213348081717125462099841553662004331893544880</span><span class=p>,</span> <span class=mi>588933808241574209971304093641158841075685907640044245151376386299524660986012995680634640</span><span class=p>,</span> <span class=mi>1766801424724722629913912280923476523227057722920132735454129158898573982958038987041903920</span><span class=p>,</span> <span class=mi>5300404274174167889741736842770429569681173168760398206362387476695721948874116961125711760</span><span class=p>,</span> <span class=mi>2406624148241409865497053131787403791641017212251092705020457063065243837716077297318876926</span><span class=p>,</span> <span class=mi>472578107583682694627080697100268916221800489738227158028018505684770508695095098927501601</span><span class=p>,</span> <span class=mi>1417734322751048083881242091300806748665401469214681474084055517054311526085285296782504803</span><span class=p>,</span> <span class=mi>4253202968253144251643726273902420245996204407644044422252166551162934578255855890347514409</span><span class=p>,</span> <span class=mi>6012314567618885853067100123445318279287362075917082309723146969977842730314430878013414050</span><span class=p>,</span> <span class=mi>4542355028575563755473142973812069920459583933721145015102735542911606182037019047981983796</span><span class=p>,</span> <span class=mi>132476411445597462691271524912324843976249507133333131241501261712896537204783557887693034</span><span class=p>,</span> <span class=mi>397429234336792388073814574736974531928748521399999393724503785138689611614350673663079102</span><span class=p>,</span> <span class=mi>1192287703010377164221443724210923595786245564199998181173511355416068834843052020989237306</span><span class=p>,</span> <span class=mi>3576863109031131492664331172632770787358736692599994543520534066248206504529156062967711918</span><span class=p>,</span> <span class=mi>3983294989952847576128914819636369903374958930784932673528249515233658509134331395874006577</span><span class=p>,</span> <span class=mi>5202590632717995826522665760647167251423625645339747063551395862190014522949857394592890554</span><span class=p>,</span> <span class=mi>2113183223872893675839839885417616836868374641989139276587482219548121559943298597720413308</span><span class=p>,</span> <span class=mi>6339549671618681027519519656252850510605123925967417829762446658644364679829895793161239924</span><span class=p>,</span> <span class=mi>5524060340574949278830401572234666614412869483872151575220634608911172030583413793425461418</span><span class=p>,</span> <span class=mi>3077592347443754032763047320180114925836106157586352811595198459711594082843967794218125900</span><span class=p>,</span> <span class=mi>2485482705190715196425063262278402318807067325744007477752242695623821244078766589625248523</span><span class=p>,</span> <span class=mi>709153778431598687411111088573264497719950830216971476223375403360502727783162975846616392</span><span class=p>,</span> <span class=mi>2127461335294796062233333265719793493159852490650914428670126210081508183349488927539849176</span><span class=p>,</span> <span class=mi>6382384005884388186699999797159380479479557471952743286010378630244524550048466782619547528</span><span class=p>,</span> <span class=mi>5652563343372070756371841994954256521036170121828127943964430523711651641239126761800384230</span><span class=p>,</span> <span class=mi>3463101355835118465387368588338884645706008071454281917826586204113032914811106699342894336</span><span class=p>,</span> <span class=mi>3642009730364808494298027066754711478416773067347794796446405928828137739980183304999553831</span><span class=p>,</span> <span class=mi>4178734853953878581030002502002191976549068055028333432305865102973452215487413121969532316</span><span class=p>,</span> <span class=mi>5788910224721088841225928807744633470945953018069949339884242625409395642009102572879467771</span><span class=p>,</span> <span class=mi>3872141999882172719949629026710015495435356760179746105586022509206264917121034132580144959</span><span class=p>,</span> <span class=mi>4869131662505971257984808381868104027604819133524187359724714844107833746909965604711305700</span><span class=p>,</span> <span class=mi>1112806313236819970226267749080427165411955106542460165107439165301579231823623228075658746</span><span class=p>,</span> <span class=mi>3338418939710459910678803247241281496235865319627380495322317495904737695470869684226976238</span><span class=p>,</span> <span class=mi>3267962481990832830172331043461902030006344811867090528933599804203252081959472259651799537</span><span class=p>,</span> <span class=mi>3056593108831951588652914432123763631317783288586220629767446729098795241425279985926269434</span><span class=p>,</span> <span class=mi>2422484989355307864094664598109348435252098718743610932268987503785424719822703164749679125</span><span class=p>,</span> <span class=mi>520160630925376690419915096066102847055045009215781839773609827845313155014972701219908198</span><span class=p>,</span> <span class=mi>1560481892776130071259745288198308541165135027647345519320829483535939465044918103659724594</span><span class=p>,</span> <span class=mi>4681445678328390213779235864594925623495405082942036557962488450607818395134754310979173782</span><span class=p>,</span> <span class=mi>549748360704076837609550197260891953083712954796007759820759984801533176497989346879262992</span><span class=p>,</span> <span class=mi>1649245082112230512828650591782675859251138864388023279462279954404599529493968040637788976</span><span class=p>,</span> <span class=mi>4947735246336691538485951775348027577753416593164069838386839863213798588481904121913366928</span><span class=p>,</span> <span class=mi>1348617064728980811729697929520197815857747485462107601093814222619473756539438779681842430</span><span class=p>,</span> <span class=mi>4045851194186942435189093788560593447573242456386322803281442667858421269618316339045527290</span><span class=p>,</span> <span class=mi>5390259245420280403703202667419837884018476222143917452810975320064302804401812224107452693</span><span class=p>,</span> <span class=mi>2676189061979747407381450605735628734652926372401650444366220593170986404299163086264099725</span><span class=p>,</span> <span class=mi>1281272848798695320280273118944943745257527970189900376065309096001998208444352465763169998</span><span class=p>,</span> <span class=mi>3843818546396085960840819356834831235772583910569701128195927288005994625333057397289509994</span><span class=p>,</span> <span class=mi>4784161302047710980658379372242551248616500584694052427554429180507022871546035398839400805</span><span class=p>,</span> <span class=mi>857895231862039138246980720203768828446999460052055368596582174499146605731832610459944061</span><span class=p>,</span> <span class=mi>2573685695586117414740942160611306485340998380156166105789746523497439817195497831379832183</span><span class=p>,</span> <span class=mi>973762749617805342358747783571976997321743993453447360335886886981358447133356701110367372</span><span class=p>,</span> <span class=mi>2921288248853416027076243350715930991965231980360342081007660660944075341400070103331102116</span><span class=p>,</span> <span class=mi>2016570409419701179364651353885850517194444794065975285989629299321265019747073516964177171</span><span class=p>,</span> <span class=mi>6049711228259103538093954061657551551583334382197925857968887897963795059241220550892531513</span><span class=p>,</span> <span class=mi>4654545010496216810553704788448769737347500852563675659839958326869463168817388066619336185</span><span class=p>,</span> <span class=mi>469046357207556627932956968822424294640000263660925065453169613586467497545890613799750201</span><span class=p>,</span> <span class=mi>1407139071622669883798870906467272883920000790982775196359508840759402492637671841399250603</span><span class=p>,</span> <span class=mi>4221417214868009651396612719401818651760002372948325589078526522278207477913015524197751809</span><span class=p>,</span> <span class=mi>5916957307463482052325759459943513496578755971829925810202226883323661429285909779564126250</span><span class=p>,</span> <span class=mi>4256283248109352353249120983306655572333765621459675516539975282949062278951455752634120396</span><span class=p>,</span> <span class=mi>6021555407187510157883284251658024258300045717363975592586573165336225832401230464873232011</span><span class=p>,</span> <span class=mi>4570077547281436669921695358450187857497634858061824863693014128986755488297417808561437679</span><span class=p>,</span> <span class=mi>215643967563216206036928678826678655090402280155372677012337019938344455985979839626054683</span><span class=p>,</span> <span class=mi>646931902689648618110786036480035965271206840466118031037011059815033367957939518878164049</span><span class=p>,</span> <span class=mi>1940795708068945854332358109440107895813620521398354093111033179445100103873818556634492147</span><span class=p>,</span> <span class=mi>5822387124206837562997074328320323687440861564195062279333099538335300311621455669903476441</span><span class=p>,</span> <span class=mi>3972572698339418885263065588437086144920082398555084923932593247983978925958093423652170969</span><span class=p>,</span> <span class=mi>5170423757877709753925118067049315976058996048650203814764427060440975773421143477927383730</span><span class=p>,</span> <span class=mi>2016682599352035458047196804624063010774485851920509530226575814301005311357156847723892836</span><span class=p>,</span> <span class=mi>6050047798056106374141590413872189032323457555761528590679727442903015934071470543171678508</span><span class=p>,</span> <span class=mi>4655554719887225318696613845092682179567870373254483857972476961687125793308138043456777170</span><span class=p>,</span> <span class=mi>472075485380582152361684138754161621301108825733349659850725518039455371018140544312073156</span><span class=p>,</span> <span class=mi>1416226456141746457085052416262484863903326477200048979552176554118366113054421632936219468</span><span class=p>,</span> <span class=mi>4248679368425239371255157248787454591709979431600146938656529662355098339163264898808658404</span><span class=p>,</span> <span class=mi>5998743768135171211901393048100421316428687147785389858936236303554334013036657903396846035</span><span class=p>,</span> <span class=mi>4501642630124419831976021747777379031883559149326067662742003543641080030203700124132279751</span><span class=p>,</span> <span class=mi>10339216092165692199907846808252178248175153948101074159305263901318081704826786338580899</span><span class=p>,</span> <span class=mi>31017648276497076599723540424756534744525461844303222477915791703954245114480359015742697</span><span class=p>,</span> <span class=mi>93052944829491229799170621274269604233576385532909667433747375111862735343441077047228091</span><span class=p>,</span> <span class=mi>279158834488473689397511863822808812700729156598729002301242125335588206030323231141684273</span><span class=p>,</span> <span class=mi>837476503465421068192535591468426438102187469796187006903726376006764618090969693425052819</span><span class=p>,</span> <span class=mi>2512429510396263204577606774405279314306562409388561020711179128020293854272909080275158457</span><span class=p>,</span> <span class=mi>789994194048242711868741624953895484218436081150632105100184700549920558365590447796346194</span><span class=p>,</span> <span class=mi>2369982582144728135606224874861686452655308243451896315300554101649761675096771343389038582</span><span class=p>,</span> <span class=mi>362653409293637504954595926323116899264673583340637988868309621438324020837177237137986569</span><span class=p>,</span> <span class=mi>1087960227880912514863787778969350697794020750021913966604928864314972062511531711413959707</span><span class=p>,</span> <span class=mi>3263880683642737544591363336908052093382062250065741899814786592944916187534595134241879121</span><span class=p>,</span> <span class=mi>3044347713787665731910011312462213821444935603182174742411007095323787558150648609696508186</span><span class=p>,</span> <span class=mi>2385748804222450293865955239124699005633555662531473270199668602460401669998809036060395381</span><span class=p>,</span> <span class=mi>409952075526803979733787019112154558199415840579368853565653123870244005543290315152056966</span><span class=p>,</span> <span class=mi>1229856226580411939201361057336463674598247521738106560696959371610732016629870945456170898</span><span class=p>,</span> <span class=mi>3689568679741235817604083172009391023794742565214319682090878114832196049889612836368512694</span><span class=p>,</span> <span class=mi>4321411702083160550948170817766230612682976548627908089239281660985627145215701716076408905</span><span class=p>,</span> <span class=mi>6216940769108934750980433755036749379347678498868673310684492299445920431193968355200097538</span><span class=p>,</span> <span class=mi>5156233633045710449213143868586363220640533202575918017986771531315839284675631479542034260</span><span class=p>,</span> <span class=mi>1974112224856037543911274209235204744519097313697652139893609226925595845120620852567844426</span><span class=p>,</span> <span class=mi>5922336674568112631733822627705614233557291941092956419680827680776787535361862557703533278</span><span class=p>,</span> <span class=mi>4272421349423244091473310486592957783269373529248767344975777675308440597179314087052341480</span><span class=p>,</span> <span class=mi>6069969711129185372555852761516930891106869440731251077893980342414360787084805468127895263</span><span class=p>,</span> <span class=mi>4715320459106462313939400888026907755918106028163651319615235660221160352348142818325427435</span><span class=p>,</span> <span class=mi>651372703038293138090045267556838350351815790460852044779001613641559048138154868918023951</span><span class=p>,</span> <span class=mi>1954118109114879414270135802670515051055447371382556134337004840924677144414464606754071853</span><span class=p>,</span> <span class=mi>5862354327344638242810407408011545153166342114147668403011014522774031433243393820262215559</span><span class=p>,</span> <span class=mi>4092474307752820924703064827510750542096524048412903294966338201300172290823907874728388323</span><span class=p>,</span> <span class=mi>5530128586117915872245115784270309167588320998223658927865661920389555868018586831156035792</span><span class=p>,</span> <span class=mi>3095797084072653813007189956287042585362460700640874869530280394146745595149486907409849022</span><span class=p>,</span> <span class=mi>2540096915077414537157491170599185297386130954907573651557488498929275780995323929200417889</span><span class=p>,</span> <span class=mi>872996408091696709608394813535613433457141717707669997639112813276866338532834994572124490</span><span class=p>,</span> <span class=mi>2618989224275090128825184440606840300371425153123009992917338439830599015598504983716373470</span><span class=p>,</span> <span class=mi>1109673335684723484611474623558578442413024312353979021718662635980836042342378158119991233</span><span class=p>,</span> <span class=mi>3329020007054170453834423870675735327239072937061937065155987907942508127027134474359973699</span><span class=p>,</span> <span class=mi>3239765684021964459639192913765263523015967664170760238434611040316563376628266630050791920</span><span class=p>,</span> <span class=mi>2972002714925346477053500043033848110346651845497229758270480437438729125431663097123246583</span><span class=p>,</span> <span class=mi>2168713807635492529296421430839601872338704389476638317778088628805226371841852498340610572</span><span class=p>,</span> <span class=mi>6506141422906477587889264292518805617016113168429914953334265886415679115525557495021831716</span><span class=p>,</span> <span class=mi>6023835594438338959939635481032531933645837211259642945936092292225115337670398899007236794</span><span class=p>,</span> <span class=mi>4576918109033923076090749046573710883535009339748826923741571509653424004104923110963452028</span><span class=p>,</span> <span class=mi>236165652820675424544089743197247733202525725216378857158009161938350003408495746832097730</span><span class=p>,</span> <span class=mi>708496958462026273632269229591743199607577175649136571474027485815050010225487240496293190</span><span class=p>,</span> <span class=mi>2125490875386078820896807688775229598822731526947409714422082457445150030676461721488879570</span><span class=p>,</span> <span class=mi>6376472626158236462690423066325688796468194580842229143266247372335450092029385164466638710</span><span class=p>,</span> <span class=mi>5634829204193615584343111802453181472002081448496585515732036749984428267181881907341657776</span><span class=p>,</span> <span class=mi>3409898938299752949301178010835659498603742051459654633129404882931362792639372135966714974</span><span class=p>,</span> <span class=mi>3482402477758711946039455334245036037109975007363912942354861965283127373464979614871015745</span><span class=p>,</span> <span class=mi>3699913096135588936254287304473165652628673875076687870031233212338421115941802051583918058</span><span class=p>,</span> <span class=mi>4352444951266219906898783215157554499184770478215012653060346953504302343372269361722624997</span><span class=p>,</span> <span class=mi>6310040516658112818832270947210721038853060287629987002147688177001946025663671292138745814</span><span class=p>,</span> <span class=mi>5435532875693244652768655445108278199156678568859859092376359163983916068084740290357979088</span><span class=p>,</span> <span class=mi>2812009952798640154577808938800949680067533412549475363062372124929826195347947285015678910</span><span class=p>,</span> <span class=mi>1688735521255373561869348118140906581501349090633375132153763691278517581590705062017907553</span><span class=p>,</span> <span class=mi>5066206563766120685608044354422719744504047271900125396461291073835552744772115186053722659</span><span class=p>,</span> <span class=mi>1704031017017268253095975666744274316109639521670274275317167854484736225410071972102909623</span><span class=p>,</span> <span class=mi>5112093051051804759287927000232822948328918565010822825951503563454208676230215916308728869</span><span class=p>,</span> <span class=mi>1841690478874320474135623604174583927584253401002366563787805323340704019784374162867928253</span><span class=p>,</span> <span class=mi>5525071436622961422406870812523751782752760203007099691363415970022112059353122488603784759</span><span class=p>,</span> <span class=mi>3080625635587790463492455041047370430855778314991197160023542543044414169153093879753095923</span><span class=p>,</span> <span class=mi>2494582569622824488613286424880168833866083797958540523037274945622281503006144846230158592</span><span class=p>,</span> <span class=mi>736453371727926563975780576378564042897000246860570612078472153355883504565297745661346599</span><span class=p>,</span> <span class=mi>2209360115183779691927341729135692128691000740581711836235416460067650513695893236984039797</span><span class=p>,</span> <span class=mi>6628080345551339075782025187407076386073002221745135508706249380202951541087679710952119391</span><span class=p>,</span> <span class=mi>6389652362372923423617918165697344240816504371205304612052042773586932614356765546798099819</span><span class=p>,</span> <span class=mi>5674368412837676467125597100568147805047010819585811922089422953738875834164023054336041103</span><span class=p>,</span> <span class=mi>3528516564231935597648633905180558497738530164727333852201563494194705493585795576949864955</span><span class=p>,</span> <span class=mi>3838255355555259891081823017279733034514339347166950599571337799073155476304249937820465688</span><span class=p>,</span> <span class=mi>4767471729525232771381390353577256644841766894485800841680660713708505424459613020432267887</span><span class=p>,</span> <span class=mi>807826514294604510416013664207885017122798389427300610975276774103594264472565475238545307</span><span class=p>,</span> <span class=mi>2423479542883813531248040992623655051368395168281901832925830322310782793417696425715635921</span><span class=p>,</span> <span class=mi>523144291510893691880044279609022695403934357830654541744138283421387375799952484117778586</span><span class=p>,</span> <span class=mi>1569432874532681075640132838827068086211803073491963625232414850264162127399857452353335758</span><span class=p>,</span> <span class=mi>4708298623598043226920398516481204258635409220475890875697244550792486382199572357060007274</span><span class=p>,</span> <span class=mi>630307196513035877033038152919727858503725367397570713025028285355537137692443485121763468</span><span class=p>,</span> <span class=mi>1890921589539107631099114458759183575511176102192712139075084856066611413077330455365290404</span><span class=p>,</span> <span class=mi>5672764768617322893297343376277550726533528306578136417225254568199834239231991366095871212</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>312842359600262511112435880530064569250589001035021284923827012948353613267507190924348823432</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>w</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=nb>sum</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=nb>sum</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>sum</span> <span class=o>+=</span> <span class=n>w</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=nb>sum</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>isPrime</span><span class=p>(</span><span class=n>q</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=p>(</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>q</span><span class=p>)</span> <span class=p>)</span><span class=o>%</span> <span class=n>q</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span> <span class=o>*</span> <span class=n>inverse</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>q</span><span class=p>))</span><span class=o>%</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>c</span> <span class=o>&gt;=</span> <span class=n>w</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>+=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span> <span class=o>-=</span> <span class=n>w</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># sctf{kn4p5ack_Adventur3}</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/my-blog-4/tags/%E6%9A%97%E5%8F%B7/>暗号</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>関連するコンテンツ</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/my-blog-4/contents/fermat/><div class=article-details><h2 class=article-title>フェルマーの小定理に関する暗号の問題まとめ</h2></div></a></article><article><a href=/my-blog-4/contents/luggage/><div class=article-details><h2 class=article-title>LLLを用いてナップザック暗号を解く</h2></div></a></article><article><a href=/my-blog-4/contents/lsb-attack/><div class=article-details><h2 class=article-title>LSB Decryption Oracle Attackの実装</h2></div></a></article><article><a href=/my-blog-4/contents/picoctf/><div class=article-details><h2 class=article-title>picoCTF2022 crypto writeup</h2></div></a></article><article><a href=/my-blog-4/contents/randomness/><div class=article-details><h2 class=article-title>線形合同法のパラメータ推測</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 -
2024 shibak3n's blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>テーマ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> は <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> によって設計されています。</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/my-blog-4/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>